"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5670],{5130:function(e,t,n){var i,r,a=n(7294),o=["title","titleId"];function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},s.apply(this,arguments)}function c(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}t.Z=function(e){var t=e.title,n=e.titleId,l=c(e,o);return a.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 0 24 24",width:24,fill:"#FFF","aria-labelledby":n},l),t?a.createElement("title",{id:n},t):null,i||(i=a.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"})),r||(r=a.createElement("path",{d:"m10 17 5-5-5-5v10z"})))}},4891:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ce}});var i,r,a=n(7855),o=n(5861),s=n(3144),c=n(4578),l=n(7757),u=n.n(l),h=n(7294),d=n(6010),_=n(4762),v=n(6455),f=n.n(v),p=n(4161),m="playgroundRoot_tOBI",g="playground_fZ4j",w="model_81YG",y="dropdownOverlay_dvgU",b="dropdownBox_3nPe",E="dropdownFileInput_bV87",x="control_Obj0",k="resetBtn_LQ1g",P="asideMenu_Cn5d",S="asideMenuItem_7iZ1",M="selected_0kXB",T="asideContent_ZOVl",O=n(3243),C=n(1987),D=["title","titleId"];function L(){return L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},L.apply(this,arguments)}function I(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var N,R,A,z=function(e){var t=e.title,n=e.titleId,a=I(e,D);return h.createElement("svg",L({xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 0 24 24",width:24,"aria-labelledby":n},a),t?h.createElement("title",{id:n},t):null,i||(i=h.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),r||(r=h.createElement("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zM7 9l1.41 1.41L11 7.83V16h2V7.83l2.59 2.58L17 9l-5-5-5 5z"})))},F=n(7462),Z=n(3366),j="menuItem_WZsX",G=["children","className"],B=function(e){var t=e.children,n=e.className,i=(0,Z.Z)(e,G);return h.createElement("div",(0,F.Z)({className:(0,d.Z)(j,n)},i),t)},H=[{name:"Cube",path:"/egjs-view3d/model/cube.glb"},{name:"Alarm",path:"/egjs-view3d/model/draco/alarm.glb"},{name:"Extinguisher",path:"/egjs-view3d/model/draco/extinguisher.glb"},{name:"Plant",path:"/egjs-view3d/model/draco/plant.glb"},{name:"Watch",path:"/egjs-view3d/model/draco/watch.glb"},{name:"Payphone",path:"/egjs-view3d/model/draco/payphone.glb"},{name:"Suzanne",path:"/egjs-view3d/model/meshopt/suzanne.glb"},{name:"Lucy",path:"/egjs-view3d/model/draco/lucy.glb"}],U=function(e){var t=e.onSelect,n=e.onUpload,i=e.isLoading;return h.createElement(B,null,h.createElement("p",{className:"menu-label"},"Choose 3D Model"),h.createElement("div",{className:"is-flex is-flex-direction-row"},h.createElement("div",{className:(0,d.Z)({select:!0,"mr-1":!0,"is-loading":i})},h.createElement("select",{onChange:function(e){t(e)},disabled:i},H.map((function(e,t){return h.createElement("option",{key:t,value:e.path},e.name)})))),h.createElement("div",{className:"file"},h.createElement("label",{className:"file-label"},h.createElement("input",{className:"file-input",type:"file",name:"resume",accept:".glb",onChange:function(e){var t=new Map,i=e.target.files;[].concat(i).forEach((function(e){t.set(e.name,e)})),n(t)}}),h.createElement("span",{className:"file-cta"},h.createElement("span",{className:"file-icon"},h.createElement(z,null)),h.createElement("span",{className:"file-label"},"GLB"))))))},V=n(4398),W=function(e){var t=e.step,n=void 0===t?.01:t,i=e.min,r=e.max,a=e.val,o=e.onChange,s=e.className,c=void 0===s?"":s,l=e.style,u=void 0===l?{}:l;return h.createElement(V.Range,{step:n,min:i,max:r,values:[a],onChange:o,renderTrack:function(e){var t=e.props,n=e.children;return h.createElement("div",(0,F.Z)({},t,{className:c,style:Object.assign({},u,t.style,{height:"6px",width:"100%",backgroundColor:"#ccc"})}),n)},renderThumb:function(e){var t=e.props;return h.createElement("div",(0,F.Z)({},t,{style:Object.assign({},u,t.style,{height:"15px",width:"15px",borderRadius:"9999px",backgroundColor:"#485fc7"})}))}})},Y=["title","titleId"];function q(){return q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},q.apply(this,arguments)}function X(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Q,K,$=function(e){var t=e.title,n=e.titleId,i=X(e,Y);return h.createElement("svg",q({xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 0 24 24",width:24,"aria-labelledby":n},i),t?h.createElement("title",{id:n},t):null,N||(N=h.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),R||(R=h.createElement("path",{d:"M12 5.99 19.53 19H4.47L12 5.99M12 2 1 21h22L12 2z"})),A||(A=h.createElement("path",{d:"M13 16h-2v2h2zM13 10h-2v5h2z"})))},J=function(e){var t=e.onSimplify,n=e.isLoading,i=(0,h.useState)(.5),r=i[0],a=i[1],o=(0,h.useState)(7),s=o[0],c=o[1];return h.createElement(B,null,h.createElement("div",{className:"is-flex is-flex-direction-row is-align-items-center"},h.createElement($,{"data-tip":"\u26a0 WARNING: This feature is experimental and some models are not compatible",className:"mr-2",style:{fill:"#ffe08a"}}),h.createElement("span",{className:"menu-label m-0"},"Apply mesh simplify(low-poly)")),h.createElement("div",{className:"ml-4 mt-4 is-size-7 has-text-centered"},h.createElement("div",{className:"is-flex is-flex-direction-row is-align-items-center is-justify-content-center mb-2"},h.createElement("div",{className:"px-2",style:{width:"120px"}},"Target Percentage"),h.createElement(W,{style:{flex:"1"},step:.01,min:0,max:1,val:[r],onChange:function(e){a(e[0])}}),h.createElement("div",{className:"px-2",style:{width:"45px"}},r)),h.createElement("div",{className:"is-flex is-flex-direction-row is-align-items-center is-justify-content-center mb-4"},h.createElement("div",{className:"px-2",style:{width:"120px"}},"Aggressiveness"),h.createElement(W,{style:{flex:"1"},step:1,min:1,max:14,val:[s],onChange:function(e){c(e[0])}}),h.createElement("div",{className:"px-2",style:{width:"45px"}},s)),h.createElement("div",{className:"is-flex is-flex-direction-row is-align-items-center is-justify-content-center"},h.createElement("button",{className:"button is-small",disabled:n,onClick:function(){t(r,s)}},"Apply"))))},ee=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this)._onModelSelect=function(){var e=(0,o.Z)(u().mark((function e(n){var i,r,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.props.playground,r=i.view3D,a=n.target.value){e.next=5;break}return e.abrupt("return");case 5:return i.setState({isLoading:!0}),e.next=8,r.load(a);case 8:r.autoPlayer.disable(),i.originalModel=r.model,i.setState({initialized:!0,isLoading:!1});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t._onSimplify=function(e,n){var i=t.props.playground,r=i.view3D,a=i.originalModel,o=new C.mw({targetPercentage:e,aggressiveness:n}),s=new C.hl(a.scene,!0);i.setState({isLoading:!0}),requestAnimationFrame((function(){o.simplify(s);var e=new O.Hn({src:a.src,scenes:[s.object]});r.display(e),i.setState({isLoading:!1})}))},t}return(0,c.Z)(t,e),t.prototype.render=function(){var e,t,n,i,r,a,o,s,c=this,l=this.props,u=l.playground,d=l.isLoading,_=l.onFileChange;return h.createElement(h.Fragment,null,h.createElement(U,{onSelect:this._onModelSelect,onUpload:_,isLoading:d}),h.createElement(J,{onSimplify:this._onSimplify,isLoading:d}),h.createElement("p",{className:"menu-label"},"Camera"),h.createElement("div",{className:"menu-list"},h.createElement("li",{className:"is-flex is-size-7"},h.createElement("ul",{className:"pl-4",style:{width:"100%"}},h.createElement(B,null,h.createElement("div",{className:"mb-4"},"Yaw: ",null!=(e=null==(t=u.view3D)?void 0:t.camera.yaw)?e:0,"\xb0"),h.createElement(W,{className:"mb-2",step:1,min:0,max:360,val:[Math.floor(null!=(n=null==(i=u.view3D)?void 0:i.camera.yaw)?n:0)],onChange:function(e){u.view3D.camera.yaw=e[0],c.forceUpdate()}})),h.createElement(B,null,h.createElement("div",{className:"mb-4"},"Pitch: ",null!=(r=null==(a=u.view3D)?void 0:a.camera.pitch)?r:0,"\xb0"),h.createElement(W,{className:"mb-2",step:1,min:-90,max:90,val:[Math.floor(null!=(o=null==(s=u.view3D)?void 0:s.camera.pitch)?o:0)],onChange:function(e){u.view3D.camera.pitch=e[0],c.forceUpdate()}}))))))},t}(h.Component),te=ee,ne=[{name:"Artist Workshop",path:"/egjs-view3d/texture/artist_workshop_1k.hdr"},{name:"Comfy Cafe",path:"/egjs-view3d/texture/comfy_cafe_1k.hdr"},{name:"Dry Hay Field",path:"/egjs-view3d/texture/dry_hay_field_1k.hdr"},{name:"Evening Meadow",path:"/egjs-view3d/texture/evening_meadow_1k.hdr"},{name:"Royal Esplanade",path:"/egjs-view3d/texture/royal_esplanade_1k.hdr"},{name:"Spruit Sunrise",path:"/egjs-view3d/texture/spruit_sunrise_1k.hdr"},{name:"Vignaioli Night",path:"/egjs-view3d/texture/vignaioli_night_1k.hdr"},{name:"Fireplace",path:"/egjs-view3d/texture/fireplace_1k.hdr"},{name:"Venice Sunset",path:"/egjs-view3d/texture/venice_sunset_1k.hdr"},{name:"Moonless Golf",path:"/egjs-view3d/texture/moonless_golf_1k.hdr"},{name:"Studio Garden",path:"/egjs-view3d/texture/studio_garden_1k.hdr"},{name:"Studio",path:"/egjs-view3d/texture/studio_small_08_1k.hdr"}],ie=function(e){var t=e.onChange,n=e.onExposureChange,i=e.isLoading,r=(0,h.useState)(1),a=r[0],o=r[1];return h.createElement(h.Fragment,null,h.createElement(B,null,h.createElement("p",{className:"menu-label"},"Choose HDR envmap"),h.createElement("div",{className:"is-flex is-flex-direction-row"},h.createElement("div",{className:(0,d.Z)({select:!0,"mr-1":!0,"is-loading":i})},h.createElement("select",{onChange:function(e){t(e.target.value)},disabled:i},ne.map((function(e,t){return h.createElement("option",{key:t,value:e.path},e.name)})))),h.createElement("div",{className:"file"},h.createElement("label",{className:"file-label"},h.createElement("input",{className:"file-input",type:"file",name:"resume",accept:".hdr",onChange:function(e){var n=e.target.files[0];n&&t(URL.createObjectURL(n))}}),h.createElement("span",{className:"file-cta"},h.createElement("span",{className:"file-icon"},h.createElement("img",{src:"/egjs-view3d/icon/file_upload_black.svg"})),h.createElement("span",{className:"file-label"},"HDR")))))),h.createElement(B,null,h.createElement("div",{className:"menu-label mb-4"},"Exposure: ",a),h.createElement(V.Range,{step:.01,min:0,max:2,disabled:i,values:[a],onChange:function(e){o(e[0]),n(e[0])},renderTrack:function(e){var t=e.props,n=e.children;return h.createElement("div",(0,F.Z)({},t,{style:Object.assign({},t.style,{height:"6px",width:"100%",backgroundColor:"#ccc"})}),n)},renderThumb:function(e){var t=e.props;return h.createElement("div",(0,F.Z)({},t,{style:Object.assign({},t.style,{height:"15px",width:"15px",borderRadius:"9999px",backgroundColor:"#485fc7"})}))}})))},re=function(e){function t(){return e.apply(this,arguments)||this}return(0,c.Z)(t,e),t.prototype.render=function(){var e,t,n,i,r,a,o,s,c=this,l=this.props,u=l.playground,d=l.isLoading,_=l.onEnvmapChange;return h.createElement(h.Fragment,null,h.createElement(ie,{onChange:_,onExposureChange:function(e){return c.props.playground.view3D.exposure=e},isLoading:d}),h.createElement(B,{className:"is-flex is-align-items-center"},h.createElement("span",{className:"menu-label my-0 mr-2"},"Show Skybox"),h.createElement("input",{className:"checkbox",type:"checkbox",defaultChecked:!0,disabled:d,onChange:function(e){var t=c.props.playground.view3D.scene;e.currentTarget.checked?t.skybox.enable():t.skybox.disable()}})),h.createElement(B,{className:"is-flex is-align-items-center"},h.createElement("span",{className:"menu-label my-0 mr-2"},"Blur skybox"),h.createElement("input",{className:"checkbox",type:"checkbox",defaultChecked:!1,disabled:d,onChange:function(e){var t=c.props.playground.view3D,n=e.currentTarget.checked;t.skyboxBlur=!!n}})),h.createElement(B,null,h.createElement("div",{className:"menu-label mb-4"},"Shadow opacity: ",null!=(e=null==(t=u.view3D)?void 0:t.scene.shadowPlane.opacity)?e:.3),h.createElement(W,{className:"mb-2",step:.01,min:0,max:1,val:null!=(n=null==(i=u.view3D)?void 0:i.scene.shadowPlane.opacity)?n:0,onChange:function(e){u.view3D.scene.shadowPlane.opacity=e[0],c.forceUpdate()}})),h.createElement(B,null,h.createElement("div",{className:"menu-label mb-4"},"Shadow hardness: ",null!=(r=null==(a=u.view3D)?void 0:a.scene.shadowPlane.hardness)?r:6),h.createElement(W,{className:"mb-2",step:1,min:1,max:14,val:null!=(o=null==(s=u.view3D)?void 0:s.scene.shadowPlane.hardness)?o:6,onChange:function(e){u.view3D.scene.shadowPlane.hardness=e[0],c.forceUpdate()}})))},t}(h.Component),ae=re,oe=n(7543),se=n(5733),ce=n.n(se),le=n(3162),ue=n(8519),he=["title","titleId"];function de(){return de=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},de.apply(this,arguments)}function _e(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ve,fe,pe=function(e){var t=e.title,n=e.titleId,i=_e(e,he);return h.createElement("svg",de({xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 0 24 24",width:24,"aria-labelledby":n},i),t?h.createElement("title",{id:n},t):null,Q||(Q=h.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})),K||(K=h.createElement("path",{d:"M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"})))},me=n(8630),ge=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this)._downloadModel=(0,o.Z)(u().mark((function e(){var n,i,r,a,s,c,l,h,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.props.playground,i=document.querySelector("#model-webp").checked,r=document.querySelector("#model-tlod").checked,a=parseFloat(document.querySelector("#model-tlod-0").value),s=parseFloat(document.querySelector("#model-tlod-1").value),n.setState({isLoading:!0});try{c=n.view3D,l=c.model,h=l.meshes.reduce((function(e,t){return Array.isArray(t.material)?[].concat(e,t.material):[].concat(e,[t.material])}),[]),d=new Map,h.forEach((function(e){for(var t in e)if(e[t]&&t.toLowerCase().endsWith("map")&&e[t].isTexture){var n=e[t];n.image.src=n.uuid,d.set(n.uuid,n)}})),(new oe.M).parse(l.scene,function(){var e=(0,o.Z)(u().mark((function e(n){var c,h,_,v,f,p,m,g,w,y,b;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n,h=/(\w+)\.\w+$/i.exec(l.src),_=h&&h[1]?h[1]:"model",v=document.createElement("canvas"),f=v.getContext("2d"),p=new(ce()),c.images||(c.images=[]),c.textures||(c.textures=[]),m=[].concat(c.images),g=[].concat(c.textures),w="EXT_texture_webp",c.extensionsUsed||(c.extensionsUsed=[]),g.forEach((function(e){e.extensions||(e.extensions={})})),i&&(c.extensionsUsed.includes(w)||c.extensionsUsed.push(w),g.forEach((function(e){var t=e.source;e.extensions[w]={source:t+m.length}})),m.map((function(e,t){var n=""+_+t;c.images.push({mimeType:"image/webp",uri:n+".webp"})}))),y=m.map(function(){var e=(0,o.Z)(u().mark((function e(n,o){var h,m,y,b,E,x,k,P,S,M,T,O,C,D,L,I;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E=n.uri.split("/"),x=g.find((function(e){return e.source===o})),k=d.get(E[E.length-1]),P=null!=(h=null==(m=l.json)?void 0:m.images)?h:[],S=null!=(y=null==(b=P[o])?void 0:b.mimeType)?y:"image/png",M=S.split("/")[1],T=""+_+o,O=k.image,C=(0,ue.uZ)(O.width,a,s),!(r&&C>a)){e.next=31;break}return D=[],L=function(e,t){var n=c.images.length,r=c.textures.length,a={mimeType:S,uri:e+"."+M},o={sampler:x.sampler,source:n,extensions:{}},s={size:t,index:r};if(c.images.push(a),i){var l=c.images.length;c.images.push({mimeType:"image/webp",uri:e+".webp"}),o.extensions[w]={source:l}}c.textures.push(o),D.push(s)},t._drawTextureImage(k,v,f,a,a),e.next=15,t._saveImage(p,v,S,i,T,M);case 15:if(!(C>(I=2048))){e.next=21;break}return t._drawTextureImage(k,v,f,I,I),e.next=20,t._saveImage(p,v,S,i,T+"_"+I,M);case 20:L(T+"_"+I,I);case 21:if(!(C>a)){e.next=26;break}return t._drawTextureImage(k,v,f,C,C),e.next=25,t._saveImage(p,v,S,i,T+"_"+C,M);case 25:L(T+"_"+C,C);case 26:n.uri=T+"."+M,x.extras||(x.extras={}),x.extras[me.Fy]={levels:D},e.next=35;break;case 31:return t._drawTextureImage(k,v,f,C,C),e.next=34,t._saveImage(p,v,S,i,T,M);case 34:n.uri=T+"."+M;case 35:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=18,Promise.all(y);case 18:return e.next=20,Promise.all(c.buffers.map(function(){var e=(0,o.Z)(u().mark((function e(t,n){var i,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.buffers.length>1?_+"-"+n+".bin":_+".bin",e.next=3,fetch(t.uri).then((function(e){return e.arrayBuffer()}));case 3:r=e.sent,p.file(i,r),t.uri=i;case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 20:return p.file(_+".gltf",JSON.stringify(c,null,2)),e.next=23,p.generateAsync({type:"blob"});case 23:b=e.sent,(0,le.saveAs)(b,_+".zip");case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{binary:!1,animations:l.animations,includeCustomExtensions:!0,embedImages:!1})}catch(_){f().fire({title:"Error!",text:_.message,icon:"error"})}finally{n.setState({isLoading:!1})}case 7:case"end":return e.stop()}}),e)}))),t._downloadPoster=function(){var e=t.props.playground.view3D,n=e.renderer.canvas,i=e.renderer.size,r=parseFloat(document.querySelector("#poster-width").value),a=parseFloat(document.querySelector("#poster-height").value);e.renderer.threeRenderer.setSize(r,a,!0),e.once("resize",(function(){e.screenshot("poster"),e.renderer.threeRenderer.setSize(i.width,i.height,!1),n.style.width=null,n.style.height=null}))},t}(0,c.Z)(t,e);var n=t.prototype;return n.render=function(){var e=this.props.isLoading;return h.createElement(h.Fragment,null,h.createElement(B,null,h.createElement("span",{className:"menu-label my-0"},"Download 3D Model"),h.createElement("div",{className:"menu-list"},h.createElement("li",{className:"is-flex is-size-7"},h.createElement("ul",null,h.createElement("div",{className:"mt-2"},h.createElement("span",{className:"my-0 mr-1"},"Include WebP Textures"),h.createElement("span",{className:"icon is-small mr-2",style:{verticalAlign:"top"}},h.createElement(pe,{"data-tip":"WebP images are smaller than jpeg/png images, but have lesser browser coverage. png/jpeg images will be used as fallback."})),h.createElement("input",{id:"model-webp",className:"checkbox",type:"checkbox",defaultChecked:!0,disabled:e})),h.createElement("div",{className:"mt-2"},h.createElement("span",{className:"my-0 mr-1"},"Include Multiple Levels of Textures"),h.createElement("span",{className:"icon is-small mr-2",style:{verticalAlign:"top"}},h.createElement(pe,{"data-tip":"Include multiple levels(sizes) of textures. Low-res textures will be loaded first, and will be replaced with highres textures after they're loaded."})),h.createElement("input",{id:"model-tlod",className:"checkbox",type:"checkbox",defaultChecked:!0,disabled:e})),h.createElement("div",{className:"mt-2"},h.createElement("span",{className:"my-0 mr-2"},"Minimum Texture Size"),h.createElement("input",{id:"model-tlod-0",className:"input is-small",type:"number",defaultValue:256,min:1,disabled:e})),h.createElement("div",{className:"mt-2"},h.createElement("span",{className:"my-0 mr-2"},"Maximum Texture Size"),h.createElement("input",{id:"model-tlod-1",className:"input is-small",type:"number",defaultValue:8192,min:1,disabled:e}))))),h.createElement("button",{className:"button is-small mt-2",disabled:e,onClick:this._downloadModel},h.createElement("img",{className:"mr-2",src:"/egjs-view3d/icon/file_download_black.svg"}),h.createElement("span",null,"Download 3D Model (.zip)"))),h.createElement(B,null,h.createElement("span",{className:"menu-label my-0"},"Download Poster (Preview Image)"),h.createElement("div",{className:"menu-list"},h.createElement("li",{className:"is-flex is-size-7"},h.createElement("ul",null,h.createElement("div",null,h.createElement("span",{className:"my-0 mr-2"},"width"),h.createElement("input",{id:"poster-width",className:"input is-small",type:"number",defaultValue:1024,min:1,disabled:e})),h.createElement("div",{className:"mt-2"},h.createElement("span",{className:"my-0 mr-2"},"height"),h.createElement("input",{id:"poster-height",className:"input is-small",type:"number",defaultValue:1024,min:1,disabled:e}))))),h.createElement("button",{className:"button is-small mt-2",disabled:e,onClick:this._downloadPoster},h.createElement("img",{className:"mr-2",src:"/egjs-view3d/icon/image.svg"}),h.createElement("span",null,"Download Poster (.png)"))))},n._drawTextureImage=function(e,t,n,i,r){var a=e.image;t.width=i,t.height=r;var o=i/a.width,s=r/a.height;if(e.flipY?(n.translate(0,t.height),n.scale(o,-s)):n.scale(o,s),"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&a instanceof OffscreenCanvas||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap)n.drawImage(a,0,0,a.width,a.height);else{for(var c=new Uint8ClampedArray(a.height*a.width*4),l=0;l<c.length;l+=4)c[l+0]=a.data[l+0],c[l+1]=a.data[l+1],c[l+2]=a.data[l+2],c[l+3]=a.data[l+3];n.putImageData(new ImageData(c,a.width,a.height),0,0)}},n._saveImage=function(e,t,n,i,r,a){var o=[new Promise((function(i){t.toBlob((function(t){e.file(r+"."+a,t),i()}),n)}))];if(i){var s=new Promise((function(n){t.toBlob((function(t){e.file(r+".webp",t),n()}),"image/webp")}));o.push(s)}return Promise.all(o)},t}(h.Component),we=ge,ye="modelInfo_6AuJ",be=n(5130),Ee=function(e){function t(){return e.apply(this,arguments)||this}(0,c.Z)(t,e);var n=t.prototype;return n.render=function(){var e=this.props.playground,t=e.originalModel;if(!t)return h.createElement(h.Fragment,null);var n=e.view3D.model!==t?e.view3D.model:null;return h.createElement("div",{className:ye},h.createElement("div",{className:"p-4"},h.createElement("div",null,"src: ",t.src),h.createElement("div",{className:"is-flex is-flex-direction-row is-align-items-center"},h.createElement("span",{className:"mr-1"},"vertices:"),h.createElement("span",null,this._getVertexCount(t)),n&&h.createElement(h.Fragment,null,h.createElement(be.Z,null),h.createElement("span",null,this._getVertexCount(n)))),h.createElement("div",{className:"is-flex is-flex-direction-row is-align-items-center"},h.createElement("span",{className:"mr-1"},"triangles:"),h.createElement("span",null,this._getTriangleCount(t)),n&&h.createElement(h.Fragment,null,h.createElement(be.Z,null),h.createElement("span",null,this._getTriangleCount(n))))))},n._getVertexCount=function(e){return e.meshes.reduce((function(e,t){return t.geometry.attributes.position?e+t.geometry.attributes.position.count:e}),0)},n._getTriangleCount=function(e){return e.meshes.reduce((function(e,t){return t.geometry.index?e+t.geometry.index.count/3:e}),0)},t}(h.Component),xe=Ee,ke=["title","titleId"];function Pe(){return Pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Pe.apply(this,arguments)}function Se(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Me=function(e){var t=e.title,n=e.titleId,i=Se(e,ke);return h.createElement("svg",Pe({xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 0 24 24",width:24,"aria-labelledby":n},i),t?h.createElement("title",{id:n},t):null,ve||(ve=h.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"})),fe||(fe=h.createElement("path",{d:"M6 13c0-1.65.67-3.15 1.76-4.24L6.34 7.34A8.014 8.014 0 0 0 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91zm14 0c0-4.42-3.58-8-8-8-.06 0-.12.01-.18.01l1.09-1.09L11.5 2.5 8 6l3.5 3.5 1.41-1.41-1.08-1.08c.06 0 .12-.01.17-.01 3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93z"})))},Te=[{name:"Model"},{name:"Environment"},{name:"Download"}],Oe=function(e){function t(t){var n;return(n=e.call(this,t)||this).onFileChange=function(){var e=(0,o.Z)(u().mark((function e(t){var i,r,a,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isLoading:!0}),e.prev=1,i=n._view3D,r=Array.from(t),a=n._loader,e.next=7,a.loadFromFiles(r.map((function(e){e[0];return e[1]})));case 7:o=e.sent,i._src=o.src,i.display(o),i.autoPlayer.disable(),n.originalModel=o,n.setState({initialized:!0,isLoading:!1}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),f().fire({title:"Error!",text:e.t0.message,icon:"error"}),n.setState({isLoading:!1});case 19:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),n.onEnvmapChange=function(){var e=(0,o.Z)(u().mark((function e(t){var i,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=n._view3D,r=i.scene.skybox.enabled,n.setState({isLoading:!0}),e.next=6,i.scene.setSkybox(t);case 6:i._skybox=t,r||i.scene.skybox.disable(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),f().fire({title:"Error!",text:e.t0.message,icon:"error"});case 13:return e.prev=13,n.setState({isLoading:!1}),URL.revokeObjectURL(t),e.finish(13);case 17:case"end":return e.stop()}}),e,null,[[0,10,13,17]])})));return function(t){return e.apply(this,arguments)}}(),n.state={initialized:!1,isLoading:!1,selectedMenu:0},n}(0,c.Z)(t,e);var i=t.prototype;return i.componentDidMount=function(){var e=this,t=n(7473).SimpleDropzone,i=new O.ZP("#playground-view3d",{src:"/egjs-view3d/model/cube.glb",skybox:"/egjs-view3d/texture/artist_workshop_1k.hdr",autoplay:!0,plugins:[new O.Ff({type:"top"})]}).on("ready",(function(){e.originalModel=i.model,e.setState({})}));O.EP.setMeshoptDecoder("/egjs-view3d/lib/meshopt_decoder.js"),this._view3D=i,this._loader=new O.EP(i),new t(document.querySelector("#playground-container"),document.querySelector("#dropdown-file")).on("drop",(function(t){for(var n,i=t.files,r=null,o=(0,a.Z)(i);!(n=o()).done;){var s=n.value[0];if(/.hdr$/i.test(s)){r=s;break}}if(r){var c=URL.createObjectURL(t.files.get(r));e.onEnvmapChange(c)}else e.onFileChange(t.files)}))},i.componentDidUpdate=function(){_.Z.rebuild()},i.render=function(){var e=this,t=this.state,n=t.initialized,i=t.isLoading,r=t.selectedMenu;return h.createElement(p.Z,null,h.createElement("div",{className:m},h.createElement("div",{id:"playground-container",className:w},!n&&h.createElement("div",{className:(0,d.Z)("has-text-white is-size-3",y)},h.createElement("label",{htmlFor:"dropdown-file",className:(0,d.Z)("p-2",b)},h.createElement("span",null,"Drag ",h.createElement("img",{src:"/egjs-view3d/img/cube_white.svg",style:{width:"48px",height:"48px"}})," glTF 2.0 files, zip or folder here"),h.createElement("input",{id:"dropdown-file",className:E,type:"file",multiple:!0}))),h.createElement("div",{id:"playground-view3d",className:(0,d.Z)("view3d-wrapper",g)},h.createElement("canvas",{className:"view3d-canvas"}),h.createElement("div",{"data-tip":"Reset Camera",className:(0,d.Z)(k,"button","is-rounded"),onClick:function(){e._view3D.camera.reset(500)}},h.createElement(Me,{width:"32",height:"32"})),h.createElement(xe,{playground:this}))),h.createElement("aside",{className:(0,d.Z)(x)},h.createElement("div",{className:(0,d.Z)(P)},Te.map((function(t,n){return h.createElement("div",{key:n,onClick:function(){e.setState({selectedMenu:n})},className:(0,d.Z)(S,n===r?M:"")},t.name)}))),h.createElement("div",{className:(0,d.Z)(T,"bulma-menu","p-4")},0===r?h.createElement(te,{playground:e,isLoading:i,onFileChange:e.onFileChange}):1===r?h.createElement(ae,{playground:e,isLoading:i,onEnvmapChange:e.onEnvmapChange}):h.createElement(we,{playground:e,isLoading:i})))),h.createElement(_.Z,{effect:"solid"}))},(0,s.Z)(t,[{key:"view3D",get:function(){return this._view3D}}]),t}(h.Component),Ce=Oe},9911:function(e,t,n){t.ZP={CODES:{WRONG_TYPE:0,ELEMENT_NOT_FOUND:1,CANVAS_NOT_FOUND:2,WEBGL_NOT_SUPPORTED:3,PROVIDE_SRC_FIRST:4,PROVIDE_WIDTH_OR_HEIGHT:5,FORMAT_NOT_SUPPORTED:6,FILE_NOT_SUPPORTED:7,NOT_INITIALIZED:8,MODEL_FAIL_TO_LOAD:9},MESSAGES:{WRONG_TYPE:function(e,t){return typeof e+" is not a "+t.map((function(e){return'"'+e+'"'})).join(" or ")+"."},ELEMENT_NOT_FOUND:function(e){return'Element with selector "'+e+'" not found.'},CANVAS_NOT_FOUND:"The canvas element was not found inside the given root element.",WEBGL_NOT_SUPPORTED:"WebGL is not supported on this browser.",PROVIDE_SRC_FIRST:'"src" should be provided before initialization.',PROVIDE_WIDTH_OR_HEIGHT:"Either width or height should be given.",FORMAT_NOT_SUPPORTED:function(e){return'Given format "'+e+'" is not supported or invalid.'},FILE_NOT_SUPPORTED:function(e){return'Given file "'+e+'" is not supported.'},NOT_INITIALIZED:"View3D is not initialized yet.",MODEL_FAIL_TO_LOAD:function(e){return'Failed to load/parse the 3D model with the given url: "'+e+'". Check "loadError" event for actual error instance.'}}}},8630:function(e,t,n){n.d(t,{xI:function(){return r},QA:function(){return a},u1:function(){return i},ei:function(){return o},Fy:function(){return s}});var i,r=["alphaMap","aoMap","bumpMap","displacementMap","emissiveMap","envMap","lightMap","map","metalnessMap","normalMap","roughnessMap"],a={HOLD:"hold",RELEASE:"release",ENABLE:"enable",DISABLE:"disable"};!function(e){e[e.NONE=0]="NONE",e[e.ONE_FINGER_HORIZONTAL=1]="ONE_FINGER_HORIZONTAL",e[e.ONE_FINGER_VERTICAL=2]="ONE_FINGER_VERTICAL",e[e.ONE_FINGER=3]="ONE_FINGER",e[e.TWO_FINGER_HORIZONTAL=4]="TWO_FINGER_HORIZONTAL",e[e.TWO_FINGER_VERTICAL=8]="TWO_FINGER_VERTICAL",e[e.TWO_FINGER=12]="TWO_FINGER",e[e.PINCH=16]="PINCH"}(i||(i={}));var o="EXT_View3D_texture_LOD",s="view3d-lod"},6872:function(e,t,n){var i=n(7326),r=n(4578),a=function(e){function t(n,r){var a;return a=e.call(this,n)||this,Object.setPrototypeOf((0,i.Z)(a),t.prototype),a.name="View3DError",a.code=r,a}return(0,r.Z)(t,e),t}((0,n(4542).Z)(Error));t.Z=a},3243:function(e,t,n){n.d(t,{_A:function(){return Tt},If:function(){return Ct},EP:function(){return kt},Ff:function(){return Lt},Hn:function(){return yt},bU:function(){return D},ZP:function(){return It}});var i,r=n(5861),a=n(3144),o=n(7326),s=n(4578),c=n(7757),l=n.n(c),u=n(4412),h=n(2921),d=n(8519),_=n(9911),v="auto",f="ready",p="loadStart",m="load",g="loadError",w="loadFinish",y="modelChange",b="resize",E="beforeRender",x="render",k="progress",P="quickLookTap",S="arStart",M="arEnd",T="arModelPlaced",O={SINE_WAVE:function(e){return Math.sin(e*Math.PI*2)},EASE_OUT_CUBIC:function(e){return 1-Math.pow(1-e,3)},EASE_OUT_BOUNCE:function(e){var t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375}},C="view3d-poster",D={LINEAR:u.EoG,REINHARD:u.CdI,CINEON:u.YGz,ACES_FILMIC:u.LY2},L="webAR",I="sceneViewer",N="quickLook",R="ar_only",A=function(){function e(e){var t=this;this._defaultRenderLoop=function(e){var n=t._view3D,i=t._renderer,r=n.scene,a=n.camera,o=n.control,s=n.autoPlayer,c=1e3*e;n.animator.update(e),o.update(c),s.update(c),n.trigger(E,{type:E,target:n,delta:c}),a.updatePosition(),i.autoClear=!1,i.clear(),r.skybox&&r.skybox.enabled&&(r.skybox.updateCamera(),i.render(r.skybox.scene,r.skybox.camera)),r.shadowPlane.render(),i.render(r.root,a.threeCamera),i.autoClear=!0,n.trigger(x,{type:x,target:n,delta:c})},this._view3D=e,this._canvas=(0,d.gE)(e.rootEl,e.canvasSelector);var n=new u.CP7({canvas:this._canvas,alpha:!0,antialias:!0,preserveDrawingBuffer:!0});if(n.toneMapping=e.toneMapping,n.toneMappingExposure=e.exposure,n.outputEncoding=u.knz,n.setClearColor(0,0),n.capabilities.isWebGL2)this._halfFloatAvailable=!0;else{var i=n.getContext(),r=i.createTexture();try{var a=new Uint16Array(4),o=i.getExtension("OES_texture_half_float");if(o){i.bindTexture(i.TEXTURE_2D,r),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,1,1,0,i.RGBA,o.HALF_FLOAT_OES,a);var s=i.getError();this._halfFloatAvailable=s===i.NO_ERROR}else this._halfFloatAvailable=!1}catch(s){this._halfFloatAvailable=!1}i.deleteTexture(r)}this._renderer=n,this._clock=new u.SUY(!1)}var t=e.prototype;return t.resize=function(){var e=this._renderer,t=this._canvas;e.xr.isPresenting||(e.setPixelRatio(window.devicePixelRatio),e.setSize(t.clientWidth,t.clientHeight,!1))},t.setAnimationLoop=function(e){var t=this._view3D,n=this._clock;n.start(),this._renderer.setAnimationLoop((function(i,r){var a=Math.min(n.getDelta(),t.maxDeltaTime);e(a,r)}))},t.stopAnimationLoop=function(){this._clock.stop(),this._renderer.setAnimationLoop(null)},(0,a.Z)(e,[{key:"canvas",get:function(){return this._canvas}},{key:"context",get:function(){return this._renderer.context}},{key:"threeRenderer",get:function(){return this._renderer}},{key:"defaultRenderLoop",get:function(){return this._defaultRenderLoop}},{key:"size",get:function(){var e=this._renderer.getSize(new u.FM8);return{width:e.width,height:e.y}}},{key:"capabilities",get:function(){var e=this._renderer;return Object.assign({},e.capabilities,{halfFloat:this._halfFloatAvailable})}}]),e}(),z=n(8567),F="mousedown",Z="mousemove",j="mouseup",G="touchstart",B="touchmove",H="touchend",U="wheel",V="resize",W="contextmenu",Y="mouseenter",q="mouseleave",X="grab",Q="grabbing",K="";!function(e){e[e.LEFT=0]="LEFT",e[e.MIDDLE=1]="MIDDLE",e[e.RIGHT=2]="RIGHT"}(i||(i={}));Number.MAX_SAFE_INTEGER;var $,J="anonymous",ee=function(e){var t=this;this._onLoadingProgress=function(e,n,i){var r=t._view3D;i.initialized=!0,i.lengthComputable=e.lengthComputable,i.loaded=e.loaded,i.total=e.total,r.trigger(k,{type:k,target:r,src:n,lengthComputable:e.lengthComputable,loaded:e.loaded,total:e.total})},this._view3D=e},te=function(e){function t(t){return e.call(this,t)||this}(0,s.Z)(t,e);var n=t.prototype;return n.load=function(e){var t=this,n=this._view3D;return new Promise((function(i,r){var a=new u.dpR,o=(0,d.uh)(n,e);a.setCrossOrigin(J),a.load(e,i,(function(n){return t._onLoadingProgress(n,e,o)}),(function(e){o.initialized=!0,r(e)}))}))},n.loadHDRTexture=function(e){var t=this,n=this._view3D;return new Promise((function(i,r){var a=new z.x;n.renderer.capabilities.halfFloat||(a.type=u.VzW);var o=(0,d.uh)(n,e);a.setCrossOrigin(J),a.load(e,(function(e){e.mapping=u.dSO,i(e)}),(function(n){return t._onLoadingProgress(n,e,o)}),(function(e){o.initialized=!0,r(e)}))}))},t}(ee),ne=n(8630),ie=n(8625),re=n(6665),ae=function(){function e(e,t){var n=void 0===t?{}:t,i=n.darkness,r=void 0===i?.5:i,a=n.mapSize,o=void 0===a?9:a,s=n.blur,c=void 0===s?3.5:s,l=n.shadowScale,h=void 0===l?1:l,d=n.planeScale,_=void 0===d?2:d;this._view3D=e,this._darkness=r,this._mapSize=o,this._blur=c,this._shadowScale=h,this._planeScale=_;var v=e.renderer.threeRenderer,f=Math.min(Math.pow(2,Math.floor(o)),v.capabilities.maxTextureSize);this._root=new u.ZAu,this._renderTarget=new u.dd2(f,f,{format:u.wk1}),this._blurTarget=new u.dd2(f,f,{format:u.wk1}),this._renderTarget.texture.generateMipmaps=!1,this._blurTarget.texture.generateMipmaps=!1;var p=new u.iKG(-.5,.5,.5,-.5,0);p.rotation.x=Math.PI/2,this._shadowCamera=p,this._root.add(p);var m=new u.iKG(-.5,.5,.5,-.5,0);this._blurCamera=m,this._setupPlanes()}var t=e.prototype;return t.updateDimensions=function(e){var t=this._root,n=this._shadowCamera,i=this._planeScale,r=e.bbox.getBoundingSphere(new u.aLr),a=2*i*r.radius,o=this._shadowScale;n.far=o*(e.bbox.max.y-e.bbox.min.y)/a,n.rotation.set(Math.PI/2,Math.PI,0,"YXZ"),t.position.copy(r.center).setY(e.bbox.min.y),t.scale.setScalar(a),n.updateProjectionMatrix()},t.render=function(){this._plane.visible=!1;var e=this._view3D,t=e.renderer,n=e.ar,i=this._shadowCamera,r=t.threeRenderer,a=n.activeSession?n.activeSession.arScene:e.scene,o=r.xr.enabled;r.xr.enabled=!1;var s=a.root,c=s.background;s.background=null,s.overrideMaterial=this._depthMaterial;var l=r.getClearAlpha();r.setClearAlpha(0);var u=r.getRenderTarget();r.setRenderTarget(this._renderTarget),r.clear(),r.render(s,i),s.overrideMaterial=null,this._blurShadow(this._blur),this._blurShadow(.4*this._blur),r.xr.enabled=o,r.setRenderTarget(u),r.setClearAlpha(l),s.background=c,this._plane.visible=!0},t._blurShadow=function(e){var t=this._view3D.renderer,n=this._blurCamera,i=t.threeRenderer,r=this._blurPlane,a=this._renderTarget,o=this._blurTarget,s=this._horizontalBlurMaterial,c=this._verticalBlurMaterial;r.visible=!0,s.uniforms.tDiffuse.value=a.texture,s.uniforms.h.value=1*e/256,s.needsUpdate=!0,r.material=s,i.setRenderTarget(o),i.render(r,n),c.uniforms.tDiffuse.value=o.texture,c.uniforms.v.value=1*e/256,c.needsUpdate=!0,r.material=c,i.setRenderTarget(a),i.render(r,n),r.visible=!1},t._setupPlanes=function(){var e=this._root,t=new u.BKK,n=new u.vBJ({opacity:this._darkness,transparent:!0,side:u._Li,depthWrite:!1,map:this._renderTarget.texture}),i=new u.Kj0(t,n);i.renderOrder=1,i.scale.set(-1,-1,1),i.rotation.order="YXZ",i.rotation.x=Math.PI/2,this._plane=i,e.add(i);var r=new u.Kj0(t);this._blurPlane=r;var a=new u.lRF;a.onBeforeCompile=function(e){e.fragmentShader="\n        "+e.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * opacity );")},this._depthMaterial=a;var o=new u.jyz(ie.P);o.depthTest=!1,this._horizontalBlurMaterial=o;var s=new u.jyz(re.Z);s.depthTest=!1,this._verticalBlurMaterial=s},(0,a.Z)(e,[{key:"root",get:function(){return this._root}},{key:"darkness",get:function(){return this._darkness},set:function(e){this._plane.material.opacity=e,this._darkness=e}},{key:"mapSize",get:function(){return this._mapSize}},{key:"blur",get:function(){return this._blur},set:function(e){this._blur=e}},{key:"shadowScale",get:function(){return this._shadowScale},set:function(e){this._shadowScale=e;var t=this._view3D.model;t&&this.updateDimensions(t)}},{key:"planeScale",get:function(){return this._planeScale}}]),e}(),oe=n(8212),se=function(){function e(e){this._view3D=e,this._scene=new u.xsS,this._camera=new u.cPb,this._enabled=!0}var t=e.prototype;return t.destroy=function(){this._disposeOldSkybox()},t.enable=function(){this._enabled=!0},t.disable=function(){this._enabled=!1},t.updateCamera=function(){var e=this._view3D,t=this._camera,n=e.camera,i=n.currentPose.pivot;t.copy(n.threeCamera),t.lookAt(i),t.updateProjectionMatrix()},t.useBlurredHDR=function(e){this._disposeOldSkybox();var t=this._view3D.renderer.threeRenderer,n=new u.xsS;n.background=e;var i=t.toneMappingExposure;t.toneMappingExposure=1;var r=new u.oAp(256,{encoding:u.knz,format:u.wk1}),a=new u._am(.1,1e3,r);a.update(t,n);for(var o=oe.F.fromCubeRenderTarget(t,r),s=new u.Wid({side:u._Li}),c=new u.Wjw(1,4),l=new u.xsS,h=new u.Kj0(c,s),d=c.getAttribute("normal"),_=0;_<d.count;_++)d.setXYZ(_,-d.getX(_),-d.getY(_),-d.getZ(_));return l.add(h),l.add(o),a.update(t,l),t.toneMappingExposure=i,this._scene.background=r.texture,this},t.useTexture=function(e){return this._scene.background=e,this},t.useColor=function(e){return this._scene.background=new u.Ilk(e),this},t._disposeOldSkybox=function(){var e=this._scene.background;e&&(e.dispose(),this._scene.background=null)},(0,a.Z)(e,[{key:"scene",get:function(){return this._scene}},{key:"camera",get:function(){return this._camera}},{key:"enabled",get:function(){return this._enabled}}]),e}(),ce=function(){function e(e){this._view3D=e,this._root=new u.xsS,this._skybox=null,this._userObjects=new u.ZAu,this._envObjects=new u.ZAu,this._fixedObjects=new u.ZAu,this._shadowPlane=new ae(e,(0,d.PO)(e.shadow));var t=this._root,n=this._userObjects,i=this._envObjects,r=this._fixedObjects,a=this._shadowPlane;n.name="userObjects",i.name="envObjects",r.name="fixedObjects",t.add(n,i,r),e.shadow&&r.add(a.root)}var t=e.prototype;return t.reset=function(e){var t=(void 0===e?{}:e).volatileOnly,n=void 0===t||t;this._removeChildsOf(this._userObjects),n||this._removeChildsOf(this._envObjects)},t.add=function(e,t){void 0===t&&(t=!0);var n=t?this._userObjects:this._envObjects,i=Array.isArray(e)?e:[e];n.add.apply(n,i)},t.remove=function(e){var t,n,i=Array.isArray(e)?e:[e];(t=this._userObjects).remove.apply(t,i),(n=this._envObjects).remove.apply(n,i)},t.setBackground=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,r,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._view3D,i=new se(n),this._skybox=i,"number"!=typeof t&&"#"!==t.charAt(0)){e.next=7;break}i.useColor(t),e.next=13;break;case 7:return r=new te(n),e.next=10,r.load(t);case 10:(a=e.sent).encoding=u.knz,i.useTexture(a);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.setSkybox=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,r,a,o,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._root,r=this._view3D,null==(n=this._skybox)||n.destroy(),!t){e.next=14;break}return a=new te(r),e.next=7,a.loadHDRTexture(t);case 7:o=e.sent,s=new se(r),r.skyboxBlur?s.useBlurredHDR(o):s.useTexture(o),this._skybox=s,i.environment=o,e.next=16;break;case 14:this._skybox=null,i.environment=null;case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.setEnvMap=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return n=this._view3D,i=new te(n),e.next=5,i.loadHDRTexture(t);case 5:r=e.sent,this._root.environment=r,e.next=10;break;case 9:this._root.environment=null;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._removeChildsOf=function(e){for(e.traverse((function(e){if(e.isMesh){var t=e;t.geometry.dispose(),(Array.isArray(t.material)?t.material:[t.material]).forEach((function(e){ne.xI.forEach((function(t){e[t]&&e[t].dispose()}))}))}}));e.children.length>0;)e.remove(e.children[0])},(0,a.Z)(e,[{key:"root",get:function(){return this._root}},{key:"skybox",get:function(){return this._skybox}},{key:"shadowPlane",get:function(){return this._shadowPlane}},{key:"userObjects",get:function(){return this._userObjects}},{key:"envObjects",get:function(){return this._envObjects}},{key:"fixedObjects",get:function(){return this._fixedObjects}}]),e}(),le=ce,ue=O.EASE_OUT_CUBIC,he=300,de={min:0,max:1},_e={min:-1/0,max:1/0},ve={min:-89.9,max:89.9},fe=[L,I,N],pe=function(){function e(e){var t=void 0===e?{}:e,n=t.duration,i=void 0===n?he:n,r=t.loop,a=void 0!==r&&r,o=t.range,s=void 0===o?de:o,c=t.easing,l=void 0===c?ue:c;this._duration=i,this._loop=a,this._range=s,this._easing=l,this._activated=!1,this.reset(0)}var t=e.prototype;return t.update=function(e){if(!this._activated)return 0;var t=this._start,n=this._end,i=this._duration,r=this._val,a=this._loop,o=this._progress+e/i;this._progress=a?(0,d.zc)(o,0,1):(0,d.uZ)(o,0,1);var s=this._easing(this._progress);return this._val=(0,d.t7)(t,n,s),!a&&this._progress>=1&&(this._activated=!1),this._val-r},t.reset=function(e){var t=this._range,n=(0,d.uZ)(e,t.min,t.max);this._start=n,this._end=n,this._val=n,this._progress=0,this._activated=!1},t.setEndDelta=function(e){var t=this._range;this._start=this._val,this._end=(0,d.uZ)(this._end+e,t.min,t.max),this._progress=0,this._activated=!0},(0,a.Z)(e,[{key:"val",get:function(){return this._val}},{key:"start",get:function(){return this._start}},{key:"end",get:function(){return this._end}},{key:"progress",get:function(){return this._progress}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}},{key:"loop",get:function(){return this._loop},set:function(e){this._loop=e}},{key:"range",get:function(){return this._range},set:function(e){this._range=e}},{key:"easing",get:function(){return this._easing},set:function(e){this._easing=e}}]),e}(),me=function(){function e(e,t,n,i){var r=void 0===i?{}:i,a=r.duration,o=void 0===a?he:a,s=r.easing,c=void 0===s?ue:s;this._enabled=!1,this._finishCallbacks=[],this._view3D=e,t=t.clone(),n=n.clone(),t.yaw=(0,d.zc)(t.yaw,0,360),n.yaw=(0,d.zc)(n.yaw,0,360),Math.abs(n.yaw-t.yaw)>180&&(n.yaw=n.yaw<t.yaw?n.yaw+360:n.yaw-360),this._motion=new pe({duration:o,range:de,easing:c}),this._from=t,this._to=n}var t=e.prototype;return t.destroy=function(){this.disable()},t.update=function(e){if(this._enabled){var t=this._view3D.camera,n=this._from,i=this._to,r=this._motion;r.update(e);var a=r.val;t.yaw=(0,d.t7)(n.yaw,i.yaw,a),t.pitch=(0,d.t7)(n.pitch,i.pitch,a),t.zoom=(0,d.t7)(n.zoom,i.zoom,a),t.pivot=n.pivot.clone().lerp(i.pivot,a),a>=1&&(this.disable(),this._finishCallbacks.forEach((function(e){return e()})))}},t.enable=function(){this._enabled||(this._enabled=!0,this._motion.reset(0),this._motion.setEndDelta(1))},t.disable=function(){this._enabled&&(this._enabled=!1)},t.onFinished=function(e){this._finishCallbacks.push(e)},t.clearFinished=function(){this._finishCallbacks=[]},t.resize=function(e){},t.sync=function(){},(0,a.Z)(e,[{key:"element",get:function(){return null}},{key:"enabled",get:function(){return this._enabled}},{key:"duration",get:function(){return this._motion.duration},set:function(e){this._motion.duration=e}},{key:"easing",get:function(){return this._motion.easing},set:function(e){this._motion.easing=e}}]),e}(),ge=function(){function e(e,t,n,i){void 0===i&&(i=[0,0,0]),this.yaw=e,this.pitch=t,this.zoom=n,this.pivot=(new u.Pa4).fromArray(i)}return e.prototype.clone=function(){return new e(this.yaw,this.pitch,this.zoom,this.pivot.toArray())},e}(),we=function(){function e(e){this._distance=0,this._baseFov=45,this._view3D=e,this._threeCamera=new u.cPb,this._maxTanHalfHFov=0;var t=(0,d.hj)(e.initialZoom)?e.initialZoom:0;this._defaultPose=new ge(e.yaw,e.pitch,t),this._currentPose=this._defaultPose.clone()}var t=e.prototype;return t.reset=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i,r,a,o,s,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=0),void 0===n&&(n=ue),i=this._view3D,r=i.control,a=this._currentPose,o=this._defaultPose,!(t<=0)){e.next=12;break}return this._currentPose=o.clone(),r.sync(),e.abrupt("return",Promise.resolve());case 12:return(s=new me(i,a,o)).duration=t,s.easing=n,s.enable(),r.disable(),c=function(e){s.update(e.delta)},i.on(E,c),e.abrupt("return",new Promise((function(e){s.onFinished((function(){r.sync(),r.enable(),i.off(E,c),e()}))})));case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.resize=function(e,t){var n=e.width,i=e.height;void 0===t&&(t=null);var r=this._view3D,a=r.control,o=r.fov,s=r.maintainSize,c=n/i;if(this._threeCamera.aspect=c,o===v)if(s&&null!=t){var l=i/t.height,u=this._currentPose.zoom,h=Math.tan((0,d.c$)((this._baseFov-u)/2));this._baseFov=(0,d.Dc)(2*Math.atan(l*h))+u}else this._applyEffectiveFov(45);else this._baseFov=o;a.zoom.updateRange()},t.fit=function(e,t){var n=this._view3D,i=this._threeCamera,r=n.control,a=this._defaultPose,o=e.bbox,s=n.fov,c=s===v?45:s,l=Array.isArray(t)?(new u.Pa4).fromArray(t):o.getCenter(new u.Pa4),h=t===v?(new u.Pa4).subVectors(o.max,o.min).lengthSq()/4:e.reduceVertices((function(e,t){return Math.max(e,t.distanceToSquared(l))}),0),_=Math.sqrt(h),f=_/Math.sin((0,d.c$)(c/2)),p=e.reduceVertices((function(e,t){var n=(new u.Pa4).subVectors(t,l),i=Math.hypot(n.x,n.z);return Math.max(e,i/(f-Math.abs(n.y)))}),0);if(s===v?(this._maxTanHalfHFov=p,this._applyEffectiveFov(c)):this._maxTanHalfHFov=s,a.pivot=l.clone(),this._distance=f,i.near=.1*(f-_),i.far=10*(f+_),r.zoom.updateRange(),!(0,d.hj)(n.initialZoom)){var m=this._baseFov,g=e.bbox,w=n.initialZoom.axis,y=n.initialZoom.ratio,b=(new u.Pa4).subVectors(g.max,g.min),E=b[w],x="y"===w?E/y:E/(y*i.aspect),k="z"!==w?f-b.z/2:f-b.x/2,P=(0,d.Dc)(2*Math.atan(x/(2*k)));a.zoom=m-P}},t.updatePosition=function(){var e=this._view3D.control,t=this._threeCamera,n=this._currentPose,i=this._distance,r=this._baseFov,a=e.zoom.range;n.yaw=(0,d.zc)(n.yaw,0,360),n.pitch=(0,d.uZ)(n.pitch,ve.min,ve.max),n.zoom=-((0,d.uZ)(r-n.zoom,a.min,a.max)-r);var o=(0,d.YC)(i,n.yaw,n.pitch),s=r-n.zoom;o.add(n.pivot),t.fov=s,t.position.copy(o),t.lookAt(n.pivot),t.updateProjectionMatrix()},t._applyEffectiveFov=function(e){var t=this._threeCamera,n=Math.tan((0,d.c$)(e/2)),i=n*Math.max(1,this._maxTanHalfHFov/n/t.aspect);this._baseFov=(0,d.Dc)(2*Math.atan(i))},(0,a.Z)(e,[{key:"threeCamera",get:function(){return this._threeCamera}},{key:"defaultPose",get:function(){return this._defaultPose}},{key:"currentPose",get:function(){return this._currentPose.clone()}},{key:"yaw",get:function(){return this._currentPose.yaw},set:function(e){this._currentPose.yaw=e}},{key:"pitch",get:function(){return this._currentPose.pitch},set:function(e){this._currentPose.pitch=e}},{key:"zoom",get:function(){return this._currentPose.zoom},set:function(e){this._currentPose.zoom=e}},{key:"baseFov",get:function(){return this._baseFov}},{key:"pivot",get:function(){return this._currentPose.pivot},set:function(e){this._currentPose.pivot=e}},{key:"fov",get:function(){return this._threeCamera.fov}},{key:"renderWidth",get:function(){return this.renderHeight*this._threeCamera.aspect}},{key:"renderHeight",get:function(){return 2*this._distance*Math.tan((0,d.c$)(this._threeCamera.getEffectiveFOV()/2))}}]),e}(),ye=we,be=function(){function e(e){var t,n=this;this._onResize=function(){n._view3d.resize()},this._skipFirstResize=(t=!0,function(){t?t=!1:n._onResize()}),this._view3d=e,this._enabled=!1,this._resizeObserver=null}var t=e.prototype;return t.enable=function(){var e=this._view3d;if(this._enabled&&this.disable(),e.useResizeObserver&&window.ResizeObserver){var t=e.renderer.canvas,n=t.getBoundingClientRect(),i=0!==n.width||0!==n.height,r=new ResizeObserver(i?this._skipFirstResize:this._onResize);r.observe(t),this._resizeObserver=r}else e.resize(),window.addEventListener(V,this._onResize);return this._enabled=!0,this},t.disable=function(){if(!this._enabled)return this;var e=this._resizeObserver;return e?(e.disconnect(),this._resizeObserver=null):window.removeEventListener(V,this._onResize),this._enabled=!1,this},(0,a.Z)(e,[{key:"enabled",get:function(){return this._enabled}}]),e}(),Ee=function(){function e(e){this._view3D=e,this._mixer=new u.Xcj(e.scene.userObjects),this._clips=[],this._actions=[],this._activeAnimationIdx=-1,this._fadePromises=[]}var t=e.prototype;return t.setClips=function(e){var t=this._mixer;this._clips=e,this._actions=e.map((function(e){var n=t.clipAction(e);return n.setEffectiveWeight(0),n}))},t.play=function(e){var t=this._actions[e];t&&(this.stop(),this._restoreTimeScale(),t.setEffectiveTimeScale(1),t.setEffectiveWeight(1),t.play(),this._activeAnimationIdx=e,this._flushFadePromises())},t.crossFade=function(){var e=(0,r.Z)(l().mark((function e(t,n,i){var r,a,o,s,c,u,h,d,_,v,f,p,m,g=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(void 0===i?{}:i).synchronize,o=void 0!==a&&a,s=this._view3D,c=this._mixer,u=this._actions,h=this._activeAnimationIdx,d=u[t],_=null!=(r=u[h])?r:d,v="loop",this._restoreTimeScale(),f=function(){d.enabled=!0,d.setEffectiveTimeScale(1),d.setEffectiveWeight(1),d.time=0,d.play(),_.crossFadeTo(d,n/1e3,!0),g._activeAnimationIdx=t},o?(p=function e(t){t.action===_&&(c.removeEventListener(v,e),f())},c.addEventListener(v,p)):f(),this._flushFadePromises(),m=new Promise((function(e){var t=function t(){d.getEffectiveWeight()<1||(s.off(E,t),e(!0))};s.on(E,t),g._fadePromises.push({listener:t,resolve:e})})),e.abrupt("return",m);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),t.fadeOut=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,r,a,o=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._view3D,i=this._actions,r=i[this._activeAnimationIdx]){e.next=5;break}return e.abrupt("return",!1);case 5:return this._flushFadePromises(),this._restoreTimeScale(),r.fadeOut(t/1e3),this._activeAnimationIdx=-1,a=new Promise((function(e){var t=function t(){r.getEffectiveWeight()>0||(n.off(E,t),e(!0))};n.on(E,t),o._fadePromises.push({listener:t,resolve:e})})),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.pause=function(){this._mixer.timeScale=0},t.resume=function(){this._restoreTimeScale()},t.stop=function(){this._actions.forEach((function(e){e.stop(),e.setEffectiveWeight(0)})),this._activeAnimationIdx=-1,this._flushFadePromises()},t.update=function(e){this._mixer.update(e)},t.reset=function(){var e=this._mixer;this.stop(),e.uncacheRoot(e.getRoot()),this._clips=[],this._actions=[]},t._restoreTimeScale=function(){this._mixer.timeScale=1},t._flushFadePromises=function(){var e=this._view3D;this._fadePromises.forEach((function(t){var n=t.resolve,i=t.listener;n(!1),e.off(E,i)})),this._fadePromises=[]},(0,a.Z)(e,[{key:"clips",get:function(){return this._clips}},{key:"mixer",get:function(){return this._mixer}},{key:"actions",get:function(){return this._actions}},{key:"animationCount",get:function(){return this._clips.length}},{key:"activeAnimation",get:function(){var e;return null!=(e=this._clips[this._activeAnimationIdx])?e:null}},{key:"activeAnimationIndex",get:function(){return this._activeAnimationIdx}},{key:"paused",get:function(){return 0===this._mixer.timeScale}}]),e}(),xe=Ee,ke=n(7855),Pe=n(6872),Se=function(e){function t(t){var n,i=void 0===t?{}:t,r=i.context,a=void 0===r?window:r,o=i.repeat,s=void 0===o?0:o,c=i.duration,l=void 0===c?he:c,u=i.easing,h=void 0===u?ue:u;return(n=e.call(this)||this)._loop=function(){var e=n._getDeltaTime(),t=n._duration,i=n._repeat,r=n._time+e,a=Math.floor(r/t);n._time=n._loopCount>=i?(0,d.uZ)(r,0,t):(0,d.zc)(r,0,t);var o=n._time/t,s={progress:o,easedProgress:n._easing(o)};n.trigger("progress",s);for(var c=0;c<a;c++){if(n._loopCount++,n._loopCount>i)return n.trigger("finish"),void n.stop();n.trigger("loop",Object.assign({},s,{loopIndex:n._loopCount}))}n._rafId=n._ctx.requestAnimationFrame(n._loop)},n._repeat=s,n._duration=l,n._easing=h,n._ctx=a,n._rafId=-1,n._time=0,n._clock=0,n._loopCount=0,n}(0,s.Z)(t,e);var n=t.prototype;return n.start=function(){this._rafId>=0||(this._updateClock(),this._loop())},n.stop=function(){this._rafId<0||(this._time=0,this._loopCount=0,this._stopLoop())},n.pause=function(){this._rafId<0||this._stopLoop()},n._stopLoop=function(){this._ctx.cancelAnimationFrame(this._rafId),this._rafId=-1},n._getDeltaTime=function(){var e=this._clock;return this._updateClock(),this._clock-e},n._updateClock=function(){this._clock=Date.now()},t}(h.Z),Me="immersive-ar",Te="local",Oe="viewer",Ce="selectstart",De="selectend",Le="generic-touchscreen",Ie={requiredFeatures:["hit-test"]},Ne=function(e){return e?{requiredFeatures:["dom-overlay"],domOverlay:{root:e}}:{}},Re={},Ae=function(e,t){return"intent://arvr.google.com/scene-viewer/1.2?"+e+"#Intent;scheme=https;package=com.google.ar.core;action=android.intent.action.VIEW;"+(t?"S.browser_fallback_url="+t+";":"")+"end;"},ze=function(e,t){return"intent://arvr.google.com/scene-viewer/1.2?"+e+"#Intent;scheme=https;package=com.google.android.googlequicksearchbox;action=android.intent.action.VIEW;"+(t?"S.browser_fallback_url="+t+";":"")+"end;"},Fe=function(e){return"https://arvr.google.com/scene-viewer?"+e},Ze=function(){function e(e){var t=(void 0===e?{}:e).scale,n=void 0===t?1:t;this.rotation=new u._fP,this._axis=new u.Pa4(0,1,0),this._enabled=!1,this._active=!1,this._prevPos=new u.FM8,this._fromQuat=new u._fP,this._toQuat=new u._fP,this._motion=new pe({range:_e}),this._userScale=n}var t=e.prototype;return t.updateRotation=function(e){this.rotation.copy(e),this._fromQuat.copy(e),this._toQuat.copy(e)},t.enable=function(){this._enabled=!0},t.disable=function(){this._enabled=!1},t.activate=function(){this._enabled&&(this._active=!0)},t.deactivate=function(){this._active=!1},t.updateAxis=function(e){this._axis.copy(e)},t.setInitialPos=function(e){this._prevPos.copy(e[0])},t.process=function(e,t){var n=e.scene,i=e.xrCam,r=t.coords;if(this._active&&1===r.length){var a=this._prevPos,o=this._motion,s=r[0],c=n.modelMovable.getWorldPosition(new u.Pa4),l=(new u.FM8).fromArray(c.project(i).toArray()),h=(0,d.cM)(l,a,s)*this._userScale,_=(new u._fP).setFromAxisAngle(this._axis,h),v=this._getInterpolatedQuaternion();this._fromQuat.copy(v),this._toQuat.premultiply(_),o.reset(0),o.setEndDelta(1),a.copy(s)}},t.update=function(e,t){var n=e.scene;if(this._active){this._motion.update(t);var i=this._getInterpolatedQuaternion();this.rotation.copy(i),n.setModelRotation(i)}},t._getInterpolatedQuaternion=function(){var e=this._motion,t=this._toQuat,n=this._fromQuat,i=e.val;return(new u._fP).copy(n).slerp(t,i)},(0,a.Z)(e,[{key:"enabled",get:function(){return this._enabled}},{key:"scale",get:function(){return this._userScale},set:function(e){this._userScale=e}}]),e}();!function(e){e[e.WAITING=0]="WAITING",e[e.TRANSLATING=1]="TRANSLATING",e[e.BOUNCING=2]="BOUNCING"}($||($={}));var je,Ge=function(){function e(e){var t=void 0===e?{}:e,n=t.hoverHeight,i=void 0===n?.1:n,r=t.bounceDuration,a=void 0===r?1e3:r,o=t.bounceEasing,s=void 0===o?O.EASE_OUT_BOUNCE:o;this._hoverPosition=new u.Pa4,this._floorPosition=new u.Pa4,this._wallRotation=new u._fP,this._dragPlane=new u.JOQ,this._enabled=!1,this._vertical=!1,this._state=$.WAITING,this._initialPos=new u.FM8,this._hoverHeight=i,this._bounceMotion=new pe({duration:a,easing:s,range:_e})}var t=e.prototype;return t.enable=function(){this._enabled=!0},t.disable=function(){this.deactivate(),this._enabled=!1},t.activate=function(){this._enabled&&(this._dragPlane.constant=this._calcDragPlaneConstant(this._floorPosition),this._state=$.TRANSLATING)},t.deactivate=function(){if(this._enabled&&!this._vertical&&this._state!==$.WAITING){this._state=$.BOUNCING;var e=this._floorPosition,t=this._hoverPosition,n=this._bounceMotion,i=t.y-e.y;n.reset(i),n.setEndDelta(-i)}else this._state=$.WAITING},t.init=function(e,t,n){this._floorPosition.copy(e),this._hoverPosition.copy(e);var i=n?new u.Pa4(0,1,0).applyQuaternion(t):new u.Pa4(0,1,0);this._dragPlane.normal.copy(i),this._wallRotation.copy(t),this._vertical=n},t.setInitialPos=function(e){this._initialPos.copy(e[0])},t.process=function(e,t){var n=e.frame,i=e.referenceSpace,r=e.xrCam,a=t.hitResults,o=this._state,s=o===$.WAITING||o===$.BOUNCING;if(a&&1===a.length&&!s){var c=a[0],l=this._floorPosition.clone(),h=this._floorPosition,d=this._hoverPosition,_=this._hoverHeight,v=this._dragPlane,f=this._vertical,p=c.results[0]&&c.results[0].getPose(i),m=p&&(new u.yGw).fromArray(p.transform.matrix),g=p&&m.elements[5]>.75,w=p&&m.elements[5]<.25,y=(new u.Pa4).setFromMatrixPosition(r.matrixWorld),b=p&&(new u.Pa4).setFromMatrixPosition(m);if(f){if(n&&(!p||!w)){var E=n.getPose(c.inputSource.targetRaySpace,i);if(!E)return;var x=E.transform.position,k=new u.Pa4(x.x,x.y,x.z).sub(y).normalize(),P=new u.zHn(y,k).intersectPlane(v,new u.Pa4);return void(P&&h.copy(P))}var S=new u.Pa4(0,1,0),M=p.transform.orientation,T=S.clone().applyQuaternion(new u._fP(M.x,M.y,M.z,M.w)).normalize(),O=(new u.Pa4).crossVectors(new u.Pa4(0,1,0),T),C=new u.Pa4(0,1,0).applyQuaternion(this._wallRotation).normalize();if(Math.acos(Math.abs(C.dot(T)))>=Math.PI/18){var D=(new u.yGw).makeBasis(O,S,T),L=new u.USm(0,0,0,"YXZ").setFromRotationMatrix(D);L.z=0,L.x=Math.PI/2,this._wallRotation.setFromEuler(L),v.normal.copy(new u.Pa4(0,1,0).applyQuaternion(this._wallRotation)),v.constant=this._calcDragPlaneConstant(b)}var I=(new u.Pa4).subVectors(b,y).normalize(),N=new u.zHn(y,I).intersectPlane(v,new u.Pa4);if(!N)return;h.copy(N)}else{if(n&&(!p||!g)){var R=n.getPose(c.inputSource.targetRaySpace,i);if(!R)return;var A=R.transform.position,z=new u.Pa4(A.x,A.y,A.z).sub(y).normalize(),F=new u.zHn(y,z).intersectPlane(v,new u.Pa4);return void(F&&(h.copy(F),h.setY(l.y),d.copy(F)))}var Z=-v.constant,j=b.y+_;j-Z>.1&&(v.constant=-j);var G=(new u.Pa4).subVectors(b,y).normalize(),B=new u.zHn(y,G).intersectPlane(v,new u.Pa4);if(!B)return;h.copy(B),h.setY(b.y),d.copy(B)}}},t.update=function(e,t){var n=e.scene,i=this._state,r=this._floorPosition,a=this._hoverPosition,o=this._bounceMotion,s=this._vertical;i===$.BOUNCING&&(o.update(t),a.setY(r.y+o.val),o.progress>=1&&(this._state=$.WAITING)),n.setRootPosition(r),s?n.setWallRotation(this._wallRotation):n.setModelHovering(a.y-r.y)},t._calcDragPlaneConstant=function(e){var t=this._vertical,n=this._dragPlane.normal.clone(),i=new u.JOQ(n,0),r=t?0:this._hoverHeight;return-(i.distanceToPoint(e)+r)},(0,a.Z)(e,[{key:"enabled",get:function(){return this._enabled}},{key:"floorPosition",get:function(){return this._floorPosition.clone()}},{key:"hoverHeight",get:function(){return this._hoverHeight},set:function(e){this._hoverHeight=e}}]),e}(),Be=function(){function e(e){var t=void 0===e?{}:e,n=t.width,i=void 0===n?.1:n,r=t.padding,a=void 0===r?20:r,o=t.offset,s=void 0===o?.05:o,c=t.font,l=void 0===c?"64px sans-serif":c,h=t.color,_=void 0===h?"white":h,v=document.createElement("canvas"),f=v.getContext("2d");f.font=l;var p=f.measureText("100%"),m=p.actualBoundingBoxLeft+p.actualBoundingBoxRight,g=p.actualBoundingBoxAscent+p.actualBoundingBoxDescent,w=(0,d.hl)(m);v.width=w,v.height=w;var y=i*(w/m);this._ctx=f,this._canvas=v,this._height=y*g/m,this._texture=new u.ROQ(v);var b=new u._12(y,y),E=new u.Kj0(b,new u.vBJ({map:this._texture,transparent:!0,depthTest:!1}));this._mesh=E,this._font=l,this._color=_,this._padding=a,this._offset=s,this.hide()}var t=e.prototype;return t.updatePosition=function(e,t,n){var i=this._mesh,r=this._height/2+this._offset+n,a=new u.Pa4(0,r,0).applyQuaternion(e.clone().invert());i.position.copy(a),i.lookAt(t)},t.updateScale=function(e){var t=this._ctx,n=this._canvas,i=this._padding,r=(100*e).toFixed(0);t.clearRect(0,0,n.width,n.height);var a=n.width/2,o=n.height/2,s=t.measureText(r+"%"),c=(s.actualBoundingBoxLeft+s.actualBoundingBoxRight)/2,l=(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)/2;t.beginPath(),t.moveTo(a-c,o-l-i),t.lineTo(a+c,o-l-i),t.quadraticCurveTo(a+c+i,o-l-i,a+c+i,o-l),t.lineTo(a+c+i,o+l),t.quadraticCurveTo(a+c+i,o+l+i,a+c,o+l+i),t.lineTo(a-c,o+l+i),t.quadraticCurveTo(a-c-i,o+l+i,a-c-i,o+l),t.lineTo(a-c-i,o-l),t.quadraticCurveTo(a-c-i,o-l-i,a-c,o-l-i),t.closePath(),t.lineWidth=5,t.fillStyle="rgba(0, 0, 0, 0.3)",t.fill(),t.stroke(),t.font=this._font,t.textAlign="center",t.textBaseline="middle",t.strokeStyle=this._color,t.fillStyle=this._color,t.fillText(r+"%",a,o),this._texture.needsUpdate=!0,this._mesh.scale.setScalar(1/e)},t.show=function(){this._mesh.visible=!0},t.hide=function(){this._mesh.visible=!1},(0,a.Z)(e,[{key:"mesh",get:function(){return this._mesh}},{key:"height",get:function(){return this._height}},{key:"visible",get:function(){return this._mesh.visible}}]),e}(),He=function(){function e(e){var t=void 0===e?{}:e,n=t.min,i=void 0===n?.05:n,r=t.max,a=void 0===r?5:r;this._enabled=!1,this._active=!1,this._prevCoordDistance=-1,this._scaleMultiplier=1,this._ui=new Be,this._motion=new pe({duration:0,range:{min:i,max:a}}),this._motion.reset(1),this._ui=new Be}var t=e.prototype;return t.setInitialScale=function(e){var t=e.scene,n=e.model,i=e.floorPosition,r=e.xrCam,a=e.initialScale,o=this._motion,s=o.range;if(a===v){var c=2*Math.atan(1/r.projectionMatrix.elements[5]),l=r.projectionMatrix.elements[0]/r.projectionMatrix.elements[5],h=r.position,_=n.bbox.max.y-n.bbox.min.y,f=h.distanceTo((new u.Pa4).addVectors(i,new u.Pa4(0,_/2,0)))*Math.tan(c/2),p=f*l,m=n.bbox.getBoundingSphere(new u.aLr),g=f/m.radius,w=p/m.radius,y=(0,d.uZ)(Math.min(w,g),s.min,1);o.reset(y)}else o.reset((0,d.uZ)(a,s.min,s.max));var b=this._motion.val;this._scaleMultiplier=b,t.setModelScale(b)},t.setInitialPos=function(e){this._prevCoordDistance=(new u.FM8).subVectors(e[0],e[1]).length()},t.enable=function(){this._enabled=!0},t.disable=function(){this._enabled=!1,this.deactivate()},t.activate=function(e){this._active=!0,this._ui.show(),this._updateUIPosition(e)},t.deactivate=function(){this._active=!1,this._ui.hide(),this._prevCoordDistance=-1},t.process=function(e,t){var n=t.coords;if(2===n.length&&this._enabled&&this._active){var i=this._motion,r=(new u.FM8).subVectors(n[0],n[1]).length(),a=r-this._prevCoordDistance;i.setEndDelta(a),this._prevCoordDistance=r,this._updateUIPosition(e)}},t.update=function(e,t){var n=e.scene;if(this._enabled&&this._active){var i=this._motion;i.update(t),this._scaleMultiplier=i.val,this._ui.updateScale(this._scaleMultiplier),n.setModelScale(this._scaleMultiplier)}},t._updateUIPosition=function(e){var t=e.view3D,n=e.scene,i=e.xrCam,r=e.vertical,a=t.model,o=(new u.Pa4).setFromMatrixPosition(i.matrixWorld),s=r?a.bbox.getBoundingSphere(new u.aLr).radius:a.bbox.max.y-a.bbox.min.y;this._ui.updatePosition(n.root.quaternion,o,s)},(0,a.Z)(e,[{key:"enabled",get:function(){return this._enabled}},{key:"scale",get:function(){return this._scaleMultiplier}},{key:"ui",get:function(){return this._ui}},{key:"range",get:function(){return this._motion.range}}]),e}(),Ue=function(){function e(e){var t=void 0===e?{}:e,n=t.ringOpacity,i=void 0===n?.3:n,r=t.dirIndicatorOpacity,a=void 0===r?1:r,o=t.fadeoutDuration,s=void 0===o?1e3:o,c=Math.PI/18,l=new u.o8S(.975,1,150,1,-6*c,30*c);l.rotateX(-Math.PI/2);for(var h=new u.o8S(.96,1.015,30,1,25*c,4*c),d=h.attributes.position,_=Math.floor(11*d.count/16),v=Math.floor(13*d.count/16),f=Math.floor((v-_+1)/2),p=(new u.Pa4).fromBufferAttribute(d,_).y,m=_;m<v;m++){var g=m-_,w=.025*(f-Math.abs(g-f));d.setY(m,p-w)}h.rotateX(-Math.PI/2);var y=new u.vBJ({transparent:!0,opacity:i,color:16777215}),b=new u.vBJ({transparent:!0,opacity:a,color:16777215}),E=new u.Kj0(l,y),x=new u.Kj0(h,b),k=new u.ZAu;k.add(E,x),k.position.setY(1e-4),this._mesh=k,this._ring=E,this._arrow=x,this._animator=new pe({duration:s}),this._opacityRange={min:i,max:a},this.hide()}var t=e.prototype;return t.updateSize=function(e){this._mesh.scale.setScalar(e.bbox.getBoundingSphere(new u.aLr).radius)},t.update=function(e){var t=e.delta,n=e.rotation,i=this._mesh,r=this._animator;if(i.visible){r.update(t);var a=this._ring.material,o=this._arrow.material,s=this._opacityRange;a.opacity=r.val*s.min,o.opacity=r.val*s.max,r.val<=0&&(i.visible=!1),i.quaternion.copy(n),i.updateMatrix()}},t.show=function(){this._mesh.visible=!0,this._animator.reset(1)},t.hide=function(){this._mesh.visible=!1},t.fadeout=function(){this._animator.setEndDelta(-1)},(0,a.Z)(e,[{key:"mesh",get:function(){return this._mesh}}]),e}();!function(e){e[e.WAITING=0]="WAITING",e[e.IN_DEADZONE=1]="IN_DEADZONE",e[e.OUT_OF_DEADZONE=2]="OUT_OF_DEADZONE"}(je||(je={}));var Ve=function(){function e(e){var t=(void 0===e?{}:e).size,n=void 0===t?.1:t;this._state=je.WAITING,this._detectedGesture=ne.u1.NONE,this._testingGestures=ne.u1.NONE,this._lastFingerCount=0,this._aspect=1,this._prevOneFingerPos=new u.FM8,this._prevTwoFingerPos=new u.FM8,this._initialTwoFingerDistance=0,this._prevOneFingerPosInitialized=!1,this._prevTwoFingerPosInitialized=!1,this._size=n}var t=e.prototype;return t.setAspect=function(e){this._aspect=e},t.setFirstInput=function(e){var t=e.length;1!==t||this._prevOneFingerPosInitialized?2!==t||this._prevTwoFingerPosInitialized||(this._prevTwoFingerPos.copy((new u.FM8).addVectors(e[0],e[1]).multiplyScalar(.5)),this._initialTwoFingerDistance=(new u.FM8).subVectors(e[0],e[1]).length(),this._prevTwoFingerPosInitialized=!0):(this._prevOneFingerPos.copy(e[0]),this._prevOneFingerPosInitialized=!0),this._lastFingerCount=t,this._state=je.IN_DEADZONE},t.addTestingGestures=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._testingGestures=this._testingGestures|t.reduce((function(e,t){return e|t}),ne.u1.NONE)},t.cleanup=function(){this._testingGestures=ne.u1.NONE,this._lastFingerCount=0,this._prevOneFingerPosInitialized=!1,this._prevTwoFingerPosInitialized=!1,this._initialTwoFingerDistance=0,this._detectedGesture=ne.u1.NONE,this._state=je.WAITING},t.applyScreenAspect=function(e){var t=this._aspect;e.forEach((function(e){t>1?e.setY(e.y*t):e.setX(e.x/t)}))},t.check=function(e){var t=this._state,n=this._size,i=this._testingGestures,r=this._lastFingerCount,a=e.length;if(t===je.OUT_OF_DEADZONE)return this._detectedGesture;if(this._lastFingerCount=a,this.applyScreenAspect(e),a!==r)return this.setFirstInput(e),ne.u1.NONE;if(1===a){var o=e[0],s=this._prevOneFingerPos.clone(),c=(new u.FM8).subVectors(o,s);c.length()>n&&(Math.abs(c.x)>Math.abs(c.y)?ne.u1.ONE_FINGER_HORIZONTAL&i&&(this._detectedGesture=ne.u1.ONE_FINGER_HORIZONTAL):ne.u1.ONE_FINGER_VERTICAL&i&&(this._detectedGesture=ne.u1.ONE_FINGER_VERTICAL))}else if(2===a){var l=(new u.FM8).addVectors(e[1],e[0]).multiplyScalar(.5),h=this._prevTwoFingerPos.clone(),d=(new u.FM8).subVectors(l,h);d.length()>n&&(Math.abs(d.x)>Math.abs(d.y)?ne.u1.TWO_FINGER_HORIZONTAL&i&&(this._detectedGesture=ne.u1.TWO_FINGER_HORIZONTAL):ne.u1.TWO_FINGER_VERTICAL&i&&(this._detectedGesture=ne.u1.TWO_FINGER_VERTICAL));var _=(new u.FM8).subVectors(e[1],e[0]).length();Math.abs(_-this._initialTwoFingerDistance)>n&&ne.u1.PINCH&i&&(this._detectedGesture=ne.u1.PINCH)}return this._detectedGesture!==ne.u1.NONE&&(this._state=je.OUT_OF_DEADZONE),this._detectedGesture},(0,a.Z)(e,[{key:"size",get:function(){return this._size},set:function(e){this._size=e}},{key:"inDeadzone",get:function(){return this._state===je.IN_DEADZONE}}]),e}(),We=Ve,Ye=function(){function e(e,t,n){var i=this,r=n.rotate,a=n.translate,o=n.scale,s=n.ring,c=n.deadzone,l=n.initialScale;this._onSelectStart=function(e){var t=e.frame,n=i._view3D,r=i._arScene,a=i._hitTestSource,o=i._deadzoneChecker,s=i._rotateControl,c=i._translateControl,l=i._scaleControl,h=n.renderer.threeRenderer,d=h.xr.getCamera(new u.cPb),_=h.xr.getReferenceSpace();if(a&&!(d.cameras.length<=0)){var v=d.cameras[0],f=n.model;s.enabled&&o.addTestingGestures(ne.u1.ONE_FINGER),c.enabled&&o.addTestingGestures(ne.u1.ONE_FINGER),l.enabled&&o.addTestingGestures(ne.u1.PINCH);var p=t.getHitTestResultsForTransientInput(a),m=i._hitResultToVector(p);if(o.applyScreenAspect(m),o.setFirstInput(m),1===m.length){var g=t.getPose(p[0].inputSource.targetRaySpace,_);if(g){var w=(new u.Pa4).setFromMatrixPosition(v.matrixWorld),y=g.transform.position,b=new u.Pa4(y.x,y.y,y.z).sub(w).normalize(),E=new u.zHn(w,b),x=f.bbox.getBoundingSphere(new u.aLr);x.applyMatrix4(r.modelMovable.matrixWorld),E.intersectSphere(x,new u.Pa4)&&(i._modelHit=!0)}}i._vertical&&!i._modelHit||i._floorIndicator.show()}},this._onSelectEnd=function(){i._deactivate(),i._floorIndicator.fadeout()},this._view3D=e,this._arScene=t,this._vertical=!1,this._initialized=!1,this._modelHit=!1,this._hitTestSource=null,this._rotate=r,this._translate=a,this._scale=o,this._initialScale=l,this._rotateControl=new Ze((0,d.PO)(r)),this._translateControl=new Ge((0,d.PO)(a)),this._scaleControl=new He((0,d.PO)(o)),this._floorIndicator=new Ue(s),this._deadzoneChecker=new We(c)}var t=e.prototype;return t.init=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,r,a,o,s,c,u,h,d,_,v;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.model,i=t.session,r=t.size,a=t.vertical,o=t.hitPosition,s=t.hitRotation,c=this._arScene,u=this._translateControl,h=this._scaleControl,d=this._floorIndicator,_=this._deadzoneChecker,this._vertical=a,u.init(o,s,a),_.setAspect(r.height/r.width),c.add(d.mesh,h.ui.mesh),this.syncTargetModel(n),e.next=13,i.requestHitTestSourceForTransientInput({profile:Le});case 13:v=e.sent,this._hitTestSource=v,this._initialized=!0;case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.destroy=function(e){this._initialized&&(this._hitTestSource&&(this._hitTestSource.cancel(),this._hitTestSource=null),this.disable(e),this._floorIndicator.hide(),this._scaleControl.ui.hide(),e.removeEventListener(Ce,this._onSelectStart),e.removeEventListener(De,this._onSelectEnd),this._initialized=!1)},t.enable=function(e){var t=this._rotate,n=this._translate,i=this._scale,r=this._rotateControl,a=this._translateControl,o=this._scaleControl,s=this._vertical;e.addEventListener(Ce,this._onSelectStart),e.addEventListener(De,this._onSelectEnd),t&&!s&&r.enable(),n&&a.enable(),i&&o.enable()},t.disable=function(e){var t=this._rotateControl,n=this._translateControl,i=this._scaleControl;e.removeEventListener(Ce,this._onSelectStart),e.removeEventListener(De,this._onSelectEnd),this._deactivate(),t.disable(),n.disable(),i.disable()},t.update=function(e){var t,n=e.view3D,i=e.session,r=e.frame,a=this._hitTestSource;if(a&&n.model){var o=this._deadzoneChecker,s=i.inputSources,c=null!=(t=null==r?void 0:r.getHitTestResultsForTransientInput(a))?t:[],l={coords:this._hitResultToVector(c),inputSources:s,hitResults:c};o.inDeadzone?this._checkDeadzone(e,l):this._processInput(e,l),this._updateControls(e)}},t.syncTargetModel=function(e){var t=this._initialScale,n=this._translateControl.floorPosition,i=this._view3D.renderer.threeRenderer.xr.getCamera(new u.cPb).cameras[0];this._floorIndicator.updateSize(e),this._scaleControl.setInitialScale({scene:this._arScene,model:e,floorPosition:n,xrCam:i,initialScale:t})},t._deactivate=function(){this._modelHit=!1,this._deadzoneChecker.cleanup(),this._rotateControl.deactivate(),this._translateControl.deactivate(),this._scaleControl.deactivate()},t._checkDeadzone=function(e,t){var n=t.coords,i=this._arScene,r=this._rotateControl,a=this._translateControl,o=this._scaleControl,s=this._deadzoneChecker.check(n.map((function(e){return e.clone()})));if(s!==ne.u1.NONE)switch(s){case ne.u1.ONE_FINGER_HORIZONTAL:case ne.u1.ONE_FINGER_VERTICAL:this._modelHit?(a.activate(),a.setInitialPos(n)):(r.activate(),r.updateRotation(i.modelMovable.quaternion),r.setInitialPos(n));break;case ne.u1.PINCH:o.activate(e),o.setInitialPos(n)}},t._processInput=function(e,t){this._rotateControl.process(e,t),this._translateControl.process(e,t),this._scaleControl.process(e,t)},t._updateControls=function(e){var t=e.delta,n=this._arScene,i=this._rotateControl,r=this._translateControl,a=this._scaleControl,o=this._floorIndicator,s=1e3*t;i.update(e,s),r.update(e,s),a.update(e,s);var c=i.rotation,l=r.floorPosition;n.setRootPosition(l),o.update({delta:s,rotation:c})},t._hitResultToVector=function(e){return e.map((function(e){return(new u.FM8).set(e.inputSource.gamepad.axes[0],-e.inputSource.gamepad.axes[1])}))},(0,a.Z)(e,[{key:"rotate",get:function(){return this._rotateControl}},{key:"translate",get:function(){return this._translateControl}},{key:"scale",get:function(){return this._scaleControl}}]),e}(),qe=Ye,Xe=function(){function e(){this._root=new u.xsS,this._modelRoot=new u.ZAu,this._modelMovable=new u.ZAu,this._modelFixed=new u.ZAu,this._arRoot=new u.ZAu;var e=this._root,t=this._modelRoot,n=this._modelMovable,i=this._modelFixed,r=this._arRoot;t.add(n),e.add(t,i,r)}var t=e.prototype;return t.init=function(e){var t=this._root,n=this._modelMovable,i=this._modelFixed,r=e.scene;n.add(r.userObjects,r.envObjects),i.add(r.fixedObjects),t.environment=r.root.environment,this.hideModel()},t.destroy=function(e){var t=this._modelMovable,n=this._modelFixed,i=e.scene;[].concat(t.children,n.children).forEach((function(e){i.root.add(e)}))},t.showModel=function(){this._modelRoot.visible=!0},t.hideModel=function(){this._modelRoot.visible=!1},t.add=function(){var e;(e=this._arRoot).add.apply(e,arguments)},t.setRootPosition=function(e){this._root.position.copy(e)},t.setWallRotation=function(e){this._root.quaternion.copy(e)},t.updateModelRootPosition=function(e,t){var n=this._modelRoot;if(t){var i=e.bbox.max.y-e.bbox.min.y;n.position.setZ(i/2),n.position.setY(-e.bbox.min.z),n.rotateX(-Math.PI/2),n.updateMatrix()}},t.setModelHovering=function(e){this._modelMovable.position.setY(e)},t.setModelRotation=function(e){this._modelMovable.quaternion.copy(e)},t.setModelScale=function(e){this._root.scale.setScalar(e)},(0,a.Z)(e,[{key:"root",get:function(){return this._root}},{key:"modelRoot",get:function(){return this._modelRoot}},{key:"modelMovable",get:function(){return this._modelMovable}},{key:"arRoot",get:function(){return this._arRoot}}]),e}(),Qe=Xe,Ke=function(){function e(){this._root=null}e.isAvailable=function(){return null!=window.XRDOMOverlayState};var t=e.prototype;return t.destroy=function(){this._root=null},t.getFeatures=function(e){return this._root=e,Ne(e)},(0,a.Z)(e,[{key:"root",get:function(){return this._root}}]),e}(),$e=function(){function e(){this._source=null}e.isAvailable=function(){return window.XRSession&&window.XRSession.prototype.requestHitTestSource};var t=e.prototype;return t.destroy=function(){this._source&&(this._source.cancel(),this._source=null)},t.init=function(e){var t=this;e.requestReferenceSpace(Oe).then((function(n){e.requestHitTestSource({space:n}).then((function(e){t._source=e}))}))},t.getFeatures=function(){return Ie},t.getResults=function(e){var t;return null!=(t=null==e?void 0:e.getHitTestResults(this._source))?t:[]},(0,a.Z)(e,[{key:"ready",get:function(){return null!=this._source}}]),e}(),Je=function(){function e(e,t){var n=void 0===t?{}:t,i=n.features,r=void 0===i?Re:i,a=n.vertical,o=void 0!==a&&a,s=n.overlayRoot,c=void 0===s?null:s,l=n.rotate,u=void 0===l||l,h=n.translate,d=void 0===h||h,_=n.scale,f=void 0===_||_,p=n.ring,m=void 0===p?{}:p,g=n.deadzone,w=void 0===g?{}:g,y=n.initialScale,b=void 0===y?v:y;this._view3D=e,this._modelPlaced=!1,this.features=r,this.vertical=o,this.overlayRoot=c,this._arScene=new Qe,this._control=new qe(e,this._arScene,{rotate:u,translate:d,scale:f,ring:m,deadzone:w,initialScale:b}),this._hitTest=new $e,this._domOverlay=new Ke}e.isAvailable=function(){return navigator.xr&&navigator.xr.isSessionSupported&&$e.isAvailable()&&Ke.isAvailable()?navigator.xr.isSessionSupported(Me):Promise.resolve(!1)};var t=e.prototype;return t.enter=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,a,o,s,c,h,d,_,v,f,p,m,g=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._view3D,n=t.scene,i=this._arScene,a=t.renderer,o=a.threeRenderer,s=this._control,c=this._hitTest,h=this._domOverlay,d=this.vertical,_=this._getAllXRFeatures(),o.xr.enabled=!0,e.next=13,navigator.xr.requestSession(Me,_);case 13:return v=e.sent,f=o.getPixelRatio(),o.setPixelRatio(1),o.xr.setReferenceSpaceType(Te),e.next=19,o.xr.setSession(v);case 19:i.init(t),c.init(v),p=function(){var e=(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.destroy(v),i.destroy(t),h.destroy(),o.setPixelRatio(f),a.stopAnimationLoop(),a.setAnimationLoop(a.defaultRenderLoop),t.trigger(M,{target:t,type:M,session:g});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v.addEventListener("end",p,{once:!0}),(m=new u.SUY).start(),a.stopAnimationLoop(),o.xr.setAnimationLoop((function(e,r){var a,c,l=o.xr.getCamera(new u.cPb),h=m.getDelta();if(!(l.cameras.length<=0)){var _=l.cameras[0],f=o.xr.getReferenceSpace(),p=v.renderState.baseLayer,w={width:null!=(a=null==p?void 0:p.framebufferWidth)?a:1,height:null!=(c=null==p?void 0:p.framebufferHeight)?c:1},y={view3D:t,scene:i,session:v,delta:h,frame:r,vertical:d,referenceSpace:f,xrCam:_,size:w},b=1e3*h;t.trigger(E,{type:E,target:t,delta:b}),g._modelPlaced?(s.update(y),t.animator.update(h),n.shadowPlane.render(),o.render(i.root,_)):g._initModelPosition(y),t.trigger(x,{type:x,target:t,delta:b})}})),t.trigger(S,{type:S,target:t,session:this});case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.exit=function(){var e=(0,r.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._view3D.renderer.threeRenderer.xr.getSession(),e.abrupt("return",null==t?void 0:t.end());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t._getAllXRFeatures=function(){var e,t=this.features,n=null!=(e=(0,d.S3)(this.overlayRoot))?e:this._createARRootElement();return(0,d.TS)({},this._domOverlay.getFeatures(n),this._hitTest.getFeatures(),t)},t._initModelPosition=function(e){var t=e.frame,n=e.session,i=e.size,r=e.vertical,a=e.referenceSpace,o=this._view3D,s=o.model,c=this._arScene,l=this._hitTest;if(l.ready&&s){var h=this._control,d=l.getResults(t);if(!(d.length<=0)){var _=d[0].getPose(a);if(_){var v=(new u.yGw).fromArray(_.transform.matrix);if(!(!r&&v.elements[5]<.75||r&&(v.elements[5]>=.25||v.elements[5]<=-.25))){var f=(new u.Pa4).setFromMatrixPosition(v),p=new u._fP;if(r){var m=new u.Pa4(0,1,0),g=_.transform.orientation,w=m.clone().applyQuaternion(new u._fP(g.x,g.y,g.z,g.w)).normalize(),y=(new u.Pa4).crossVectors(new u.Pa4(0,1,0),w),b=(new u.yGw).makeBasis(y,m,w),E=new u.USm(0,0,0,"YXZ").setFromRotationMatrix(b);E.z=0,E.x=Math.PI/2,p.setFromEuler(E),c.setWallRotation(p)}c.updateModelRootPosition(s,r),c.setRootPosition(f),c.showModel(),l.destroy(),this._modelPlaced=!0,o.trigger(T,{type:T,target:o,session:this,model:s}),h.init({model:s,vertical:r,session:n,size:i,hitPosition:f,hitRotation:p});var x=h.scale.scale,k=new Se({context:n,duration:1e3});k.on("progress",(function(e){c.setModelScale(e.easedProgress*x)})),k.on("finish",(function(){c.setModelScale(x),h.enable(n)})),k.start()}}}}},t._createARRootElement=function(){var e=this._view3D,t=document.createElement("div");return t.classList.add("view3d-ar-overlay"),e.rootEl.appendChild(t),e.once(M,(function(){e.rootEl.removeChild(t)})),t},(0,a.Z)(e,[{key:"control",get:function(){return this._control}},{key:"arScene",get:function(){return this._arScene}},{key:"hitTest",get:function(){return this._hitTest}},{key:"domOverlay",get:function(){return this._domOverlay}}]),e}();Je.type=L;var et=Je,tt=n(3366),nt=["file","mode","fallbackURL","title","link","sound","resizable","vertical","disableOcclusion","initialScale","shareText"],it=function(){function e(e,t){var n=void 0===t?{}:t,i=n.file,r=void 0===i?null:i,a=n.mode,o=void 0===a?R:a,s=n.fallbackURL,c=void 0===s?null:s,l=n.title,u=void 0===l?null:l,h=n.link,d=void 0===h?null:h,_=n.sound,f=void 0===_?null:_,p=n.resizable,m=void 0===p||p,g=n.vertical,w=void 0!==g&&g,y=n.disableOcclusion,b=void 0!==y&&y,E=n.initialScale,x=void 0===E?v:E,k=n.shareText,P=void 0===k?null:k,S=(0,tt.Z)(n,nt);this._view3D=e,this.file=r,this.fallbackURL=c,this.mode=o,this.title=u,this.link=d,this.sound=f,this.resizable=m,this.vertical=w,this.disableOcclusion=b,this.initialScale=x,this.shareText=P,this.otherParams=S}e.isAvailable=function(){return Promise.resolve(/android/i.test(navigator.userAgent))};var t=e.prototype;return t.enter=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,r,a,o,s,c,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._view3D.model,(i=Object.assign({title:this.title,link:this.link,sound:this.sound,mode:this.mode,initial_scale:this.initialScale},this.otherParams)).resizable=(0,d.Pr)(this.resizable),i.enable_vertical_placement=(0,d.Pr)(this.vertical),i.disable_occlusion=(0,d.Pr)(this.disableOcclusion),i.share_text=this.shareText?encodeURIComponent(this.shareText):null,r=null!=(t=this.file)?t:n.src){e.next=9;break}return e.abrupt("return",Promise.reject(new Pe.Z(_.ZP.MESSAGES.FILE_NOT_SUPPORTED(null!=(a=this.file)?a:n.src),_.ZP.CODES.FILE_NOT_SUPPORTED)));case 9:i.file=new URL(r,window.location.href).href,o=this.fallbackURL,s=Object.keys(i).filter((function(e){return null!=i[e]})).map((function(e){return e+"="+i[e]})).join("&"),c=i.mode===R?Ae(s,o):ze(s,o||Fe(s)),(u=document.createElement("a")).href=c,u.click();case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.exit=function(){return Promise.resolve()},e}();it.type=I;var rt=it,at=function(){function e(e,t){var n=void 0===t?{}:t,i=n.allowsContentScaling,r=void 0===i||i,a=n.canonicalWebPageURL,o=void 0===a?null:a,s=n.applePayButtonType,c=void 0===s?null:s,l=n.callToAction,u=void 0===l?null:l,h=n.checkoutTitle,d=void 0===h?null:h,_=n.checkoutSubtitle,v=void 0===_?null:_,f=n.price,p=void 0===f?null:f,m=n.custom,g=void 0===m?null:m,w=n.customHeight,y=void 0===w?null:w;this._view3D=e,this.allowsContentScaling=r,this.canonicalWebPageURL=o,this.applePayButtonType=c,this.callToAction=u,this.checkoutTitle=d,this.checkoutSubtitle=v,this.price=p,this.custom=g,this.customHeight=y}e.isAvailable=function(){return Promise.resolve((e=document.createElement("a")).relList&&e.relList.supports&&e.relList.supports("ar")&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1));var e};var t=e.prototype;return t.enter=function(){var e=this._view3D,t=e.iosSrc;if(!t)return Promise.reject(new Pe.Z(_.ZP.MESSAGES.FILE_NOT_SUPPORTED(""+t),_.ZP.CODES.FILE_NOT_SUPPORTED));var n=this.canonicalWebPageURL,i=this.custom,r=window.location.href,a=document.createElement("a");a.setAttribute("rel","ar"),a.appendChild(document.createElement("img"));var o=Object.entries({applePayButtonType:this.applePayButtonType,callToAction:this.callToAction,checkoutTitle:this.checkoutTitle,checkoutSubtitle:this.checkoutSubtitle,price:this.price,customHeight:this.customHeight}).reduce((function(e,t){var n=t[0],i=t[1];return i&&(e[n]=i),e}),{}),s=new URL(t,r);return this.allowsContentScaling||(o.allowsContentScaling="0"),n&&(o.canonicalWebPageURL=new URL(n,r).href),i&&(o.custom=new URL(i,r).href),s.hash=new URLSearchParams(o).toString(),a.setAttribute("href",s.href),a.addEventListener("message",(function(t){"_apple_ar_quicklook_button_tapped"===t.data&&e.trigger(P,Object.assign({},t,{type:P,target:e}))}),!1),a.click(),Promise.resolve()},t.exit=function(){return Promise.resolve()},e}();at.type=N;var ot,st=at,ct=((ot={})[L]=et,ot[I]=rt,ot[N]=st,ot),lt=function(){function e(e){var t=this;this._view3D=e,this._activeSession=null,e.on(S,(function(e){var n=e.session;t._activeSession=n})),e.on(M,(function(){t._activeSession=null}))}var t=e.prototype;return t.isAvailable=function(){var e=(0,r.Z)(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._getSesssionClasses(),e.next=3,Promise.all(t.map((function(e){return e.isAvailable()})));case 3:return n=e.sent,e.abrupt("return",n.some((function(e){return!0===e})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.enter=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,r,a,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this._view3D).model&&t.initialized){e.next=3;break}throw new Pe.Z(_.ZP.MESSAGES.NOT_INITIALIZED,_.ZP.CODES.NOT_INITIALIZED);case 3:n=this._getSesssionClasses(),i=(0,ke.Z)(n);case 5:if((r=i()).done){e.next=21;break}return a=r.value,e.prev=7,e.next=10,a.isAvailable();case 10:if(!e.sent){e.next=15;break}return o=new a(t,(0,d.PO)(t[a.type])),e.next=14,o.enter();case 14:return e.abrupt("return",Promise.resolve());case 15:e.next=19;break;case 17:e.prev=17,e.t0=e.catch(7);case 19:e.next=5;break;case 21:return e.abrupt("return",Promise.reject());case 22:case"end":return e.stop()}}),e,this,[[7,17]])})));return function(){return e.apply(this,arguments)}}(),t.exit=function(){var e=(0,r.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this._activeSession)||t.exit();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t._getSesssionClasses=function(){return this._getUsingSessionTypes().map((function(e){return ct[e]}))},t._getUsingSessionTypes=function(){var e=this._view3D;return e.arPriority.filter((function(t){return!!e[t]}))},(0,a.Z)(e,[{key:"activeSession",get:function(){return this._activeSession}}]),e}(),ut=lt,ht=function(e){function t(t,n){var r,a=void 0===n?{}:n,o=a.duration,s=void 0===o?he:o,c=a.easing,l=void 0===c?ue:c,h=a.scale,d=void 0===h?1:h,_=a.disablePitch,v=void 0!==_&&_,f=a.disableYaw,p=void 0!==f&&f;return(r=e.call(this)||this)._screenScale=new u.FM8(0,0),r._prevPos=new u.FM8(0,0),r._enabled=!1,r._onMouseDown=function(e){if(e.button===i.LEFT){var t=r._view3D.renderer.canvas;e.preventDefault(),t.focus?t.focus():window.focus(),r._prevPos.set(e.clientX,e.clientY),window.addEventListener(Z,r._onMouseMove,!1),window.addEventListener(j,r._onMouseUp,!1),r.trigger(ne.QA.HOLD)}},r._onMouseMove=function(e){e.preventDefault();var t=r._prevPos,n=new u.FM8(e.clientX,e.clientY).sub(t).multiplyScalar(r._scale);n.multiply(r._screenScale),r._xMotion.setEndDelta(n.x),r._yMotion.setEndDelta(n.y),t.set(e.clientX,e.clientY)},r._onMouseUp=function(){r._prevPos.set(0,0),window.removeEventListener(Z,r._onMouseMove,!1),window.removeEventListener(j,r._onMouseUp,!1),r.trigger(ne.QA.RELEASE)},r._onTouchStart=function(e){var t=e.touches[0];r._isFirstTouch=!0,r._prevPos.set(t.clientX,t.clientY)},r._onTouchMove=function(e){if(!(e.touches.length>1||r._isScrolling)){var t=e.touches[0],n=r._view3D.scrollable;if(!n||e.cancelable){if(r._isFirstTouch){if(n){var i=new u.FM8(t.clientX,t.clientY).sub(r._prevPos);if(Math.abs(i.y)>Math.abs(i.x))return void(r._isScrolling=!0)}r._isFirstTouch=!1}!n&&e.cancelable&&e.preventDefault(),e.stopPropagation();var a=r._prevPos,o=new u.FM8(t.clientX,t.clientY).sub(a).multiplyScalar(r._scale);o.multiply(r._screenScale),r._xMotion.setEndDelta(o.x),r._yMotion.setEndDelta(o.y),a.set(t.clientX,t.clientY)}}},r._onTouchEnd=function(e){var t=e.touches[0];t?r._prevPos.set(t.clientX,t.clientY):r._prevPos.set(0,0),r._isScrolling=!1},r._view3D=t,r._scale=d,r._duration=s,r._easing=l,r._disablePitch=v,r._disableYaw=p,r._isFirstTouch=!1,r._isScrolling=!1,r._xMotion=new pe({duration:s,range:_e,easing:l}),r._yMotion=new pe({duration:s,range:ve,easing:l}),r}(0,s.Z)(t,e);var n=t.prototype;return n.destroy=function(){this.disable()},n.update=function(e){var t=this._view3D.camera,n=this._xMotion,i=this._yMotion,r=!this._disableYaw,a=!this._disablePitch,o=new u.FM8(n.update(e),i.update(e));r&&(t.yaw+=o.x),a&&(t.pitch+=o.y)},n.resize=function(e){this._screenScale.set(360/e.width,180/e.height)},n.enable=function(){if(!this._enabled){var e=this._view3D.renderer.canvas;e.addEventListener(F,this._onMouseDown),e.addEventListener(G,this._onTouchStart,{passive:!0}),e.addEventListener(B,this._onTouchMove,{passive:this._view3D.scrollable}),e.addEventListener(H,this._onTouchEnd),this._enabled=!0,this.sync(),this.trigger(ne.QA.ENABLE)}},n.disable=function(){if(this._enabled){var e=this._view3D.renderer.canvas;e.removeEventListener(F,this._onMouseDown),window.removeEventListener(Z,this._onMouseMove),window.removeEventListener(j,this._onMouseUp),e.removeEventListener(G,this._onTouchStart),e.removeEventListener(B,this._onTouchMove),e.removeEventListener(H,this._onTouchEnd),this._enabled=!1,this.trigger(ne.QA.DISABLE)}},n.sync=function(){var e=this._view3D.camera;this._xMotion.reset(e.yaw),this._yMotion.reset(e.pitch)},(0,a.Z)(t,[{key:"enabled",get:function(){return this._enabled}},{key:"scale",get:function(){return this._scale},set:function(e){this._scale=e}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e,this._xMotion.duration=e,this._yMotion.duration=e}},{key:"easing",get:function(){return this._easing},set:function(e){this._easing=e,this._xMotion.easing=e,this._yMotion.easing=e}},{key:"disablePitch",get:function(){return this._disablePitch}},{key:"disableYaw",get:function(){return this._disableYaw}}]),t}(h.Z),dt=function(e){function t(t,n){var r,a=void 0===n?{}:n,o=a.easing,s=void 0===o?ue:o,c=a.duration,l=void 0===c?0:c,h=a.scale,d=void 0===h?1:h;return(r=e.call(this)||this)._enabled=!1,r._touchInitialized=!1,r._prevPos=new u.FM8(0,0),r._screenSize=new u.FM8(0,0),r._onMouseDown=function(e){if(e.button===i.RIGHT){var t=r._view3D.renderer.canvas;e.preventDefault(),t.focus?t.focus():window.focus(),r._prevPos.set(e.clientX,e.clientY),window.addEventListener(Z,r._onMouseMove,!1),window.addEventListener(j,r._onMouseUp,!1),window.addEventListener(W,r._onContextMenu,!1),r.trigger(ne.QA.HOLD)}},r._onMouseMove=function(e){e.preventDefault();var t=r._prevPos,n=new u.FM8(e.clientX,e.clientY).sub(t).multiplyScalar(r._scale);r._xMotion.setEndDelta(-n.x),r._yMotion.setEndDelta(n.y),t.set(e.clientX,e.clientY)},r._onMouseUp=function(){r._prevPos.set(0,0),window.removeEventListener(Z,r._onMouseMove,!1),window.removeEventListener(j,r._onMouseUp,!1),r.trigger(ne.QA.RELEASE)},r._onTouchStart=function(e){2===e.touches.length&&(!1!==e.cancelable&&e.preventDefault(),r._prevPos.copy(r._getTouchesMiddle(e.touches)),r._touchInitialized=!0)},r._onTouchMove=function(e){if(2===e.touches.length){!1!==e.cancelable&&e.preventDefault(),e.stopPropagation();var t=r._prevPos,n=r._getTouchesMiddle(e.touches);if(!r._touchInitialized)return t.copy(n),void(r._touchInitialized=!0);var i=(new u.FM8).subVectors(n,t).multiplyScalar(r._scale);r._xMotion.setEndDelta(-i.x),r._yMotion.setEndDelta(i.y),t.copy(n)}},r._onTouchEnd=function(e){2===e.touches.length?(r._prevPos.copy(r._getTouchesMiddle(e.touches)),r._touchInitialized=!0):r._touchInitialized=!1},r._onContextMenu=function(e){e.preventDefault(),window.removeEventListener(W,r._onContextMenu,!1)},r._view3D=t,r._xMotion=new pe({duration:l,range:_e,easing:s}),r._yMotion=new pe({duration:l,range:_e,easing:s}),r._scale=d,r}(0,s.Z)(t,e);var n=t.prototype;return n.destroy=function(){this.disable()},n.update=function(e){var t=this._view3D.camera,n=this._screenSize,i=new u.FM8(this._xMotion.update(e),this._yMotion.update(e)),r=new u.Pa4(1,0,0).applyQuaternion(t.threeCamera.quaternion),a=new u.Pa4(0,1,0).applyQuaternion(t.threeCamera.quaternion),o=new u.FM8(t.renderWidth,t.renderHeight).divide(n);i.multiply(o),t.pivot.add(r.multiplyScalar(i.x)),t.pivot.add(a.multiplyScalar(i.y))},n.resize=function(e){this._screenSize.copy(new u.FM8(e.width,e.height))},n.enable=function(){if(!this._enabled){var e=this._view3D.renderer.canvas;e.addEventListener(F,this._onMouseDown,!1),e.addEventListener(G,this._onTouchStart,{passive:!1,capture:!1}),e.addEventListener(B,this._onTouchMove,{passive:!1,capture:!1}),e.addEventListener(H,this._onTouchEnd,{passive:!1,capture:!1}),this._enabled=!0,this.sync(),this.trigger(ne.QA.ENABLE)}},n.disable=function(){if(this._enabled){var e=this._view3D.renderer.canvas;e.removeEventListener(F,this._onMouseDown,!1),window.removeEventListener(Z,this._onMouseMove,!1),window.removeEventListener(j,this._onMouseUp,!1),e.removeEventListener(G,this._onTouchStart,!1),e.removeEventListener(B,this._onTouchMove,!1),e.removeEventListener(H,this._onTouchEnd,!1),window.removeEventListener(W,this._onContextMenu,!1),this._enabled=!1,this.trigger(ne.QA.DISABLE)}},n.sync=function(){this._xMotion.reset(0),this._yMotion.reset(0)},n._getTouchesMiddle=function(e){return new u.FM8(e[0].clientX+e[1].clientX,e[0].clientY+e[1].clientY).multiplyScalar(.5)},(0,a.Z)(t,[{key:"enabled",get:function(){return this._enabled}},{key:"scale",get:function(){return this._scale},set:function(e){this._scale=e}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e,this._xMotion.duration=e,this._yMotion.duration=e}},{key:"easing",get:function(){return this._easing},set:function(e){this._easing=e,this._xMotion.easing=e,this._yMotion.easing=e}}]),t}(h.Z),_t=function(){function e(e,t){var n=this,i=void 0===t?{}:t,r=i.scale,a=void 0===r?1:r,o=i.duration,s=void 0===o?he:o,c=i.minFov,l=void 0===c?1:c,h=i.maxFov,d=void 0===h?v:h,_=i.easing,f=void 0===_?ue:_;this._wheelModifier=.02,this._touchModifier=.05,this._prevTouchDistance=-1,this._enabled=!1,this._onWheel=function(e){var t=n._view3D.wheelScrollable;if(0!==e.deltaY&&!t){e.preventDefault(),e.stopPropagation();var i=n._motion,r=-n._scale*n._wheelModifier*e.deltaY;i.setEndDelta(r)}},this._onTouchMove=function(e){var t=e.touches;if(2===t.length){!1!==e.cancelable&&e.preventDefault(),e.stopPropagation();var i=n._motion,r=n._prevTouchDistance,a=new u.FM8(t[0].pageX,t[0].pageY),o=new u.FM8(t[1].pageX,t[1].pageY),s=a.sub(o).length()*n._scale*n._touchModifier,c=s-r;n._prevTouchDistance=s,r<0||i.setEndDelta(c)}},this._onTouchEnd=function(){n._prevTouchDistance=-1},this._view3D=e,this._scale=a,this._duration=s,this._minFov=l,this._maxFov=d,this._easing=f,this._range={min:l,max:d===v?180:d},this._motion=new pe({duration:s,easing:f,range:{min:-1/0,max:1/0}})}var t=e.prototype;return t.destroy=function(){this.disable()},t.update=function(e){var t=this._view3D.camera,n=this._motion;t.zoom+=n.update(e)},t.resize=function(e){},t.enable=function(){if(!this._enabled){var e=this._view3D.renderer.canvas;e.addEventListener(U,this._onWheel,{passive:!1,capture:!1}),e.addEventListener(B,this._onTouchMove,{passive:!1,capture:!1}),e.addEventListener(H,this._onTouchEnd,{passive:!1,capture:!1}),this._enabled=!0,this.sync()}},t.disable=function(){if(this._enabled){var e=this._view3D.renderer.canvas;e.removeEventListener(U,this._onWheel,!1),e.removeEventListener(B,this._onTouchMove,!1),e.removeEventListener(H,this._onTouchEnd,!1),this._enabled=!1}},t.sync=function(){this._motion.reset(0)},t.updateRange=function(){var e=this._maxFov,t=this._range,n=this._view3D.camera.baseFov;e===v&&(t.max=Math.min(n+45,175))},(0,a.Z)(e,[{key:"enabled",get:function(){return this._enabled}},{key:"range",get:function(){return this._range}},{key:"scale",get:function(){return this._scale},set:function(e){this._scale=e}},{key:"duration",get:function(){return this._duration}},{key:"minFov",get:function(){return this._minFov}},{key:"maxFov",get:function(){return this._maxFov}},{key:"easing",get:function(){return this._easing}}]),e}(),vt=function(){function e(e){var t=this;this._onEnable=function(){var e=t._view3D,n=e.renderer.canvas;e.useGrabCursor&&(t._rotateControl.enabled||t._translateControl.enabled)&&n.style.cursor===K&&t._setCursor(X)},this._onDisable=function(){t._view3D.renderer.canvas.style.cursor!==K&&!t._rotateControl.enabled&&!t._translateControl.enabled&&t._setCursor(K)},this._onHold=function(){t._view3D.useGrabCursor&&(t._rotateControl.enabled||t._translateControl.enabled)&&t._setCursor(Q)},this._onRelease=function(){t._view3D.useGrabCursor&&(t._rotateControl.enabled||t._translateControl.enabled)&&t._setCursor(X)},this._view3D=e,this._rotateControl=new ht(e,(0,d.PO)(e.rotate)),this._translateControl=new dt(e,(0,d.PO)(e.translate)),this._zoomControl=new _t(e,(0,d.PO)(e.zoom)),[this._rotateControl,this._translateControl].forEach((function(e){var n;e.on(((n={})[ne.QA.HOLD]=t._onHold,n[ne.QA.RELEASE]=t._onRelease,n[ne.QA.ENABLE]=t._onEnable,n[ne.QA.DISABLE]=t._onDisable,n))}))}var t=e.prototype;return t.destroy=function(){this._rotateControl.destroy(),this._translateControl.destroy(),this._zoomControl.destroy()},t.update=function(e){this._rotateControl.update(e),this._translateControl.update(e),this._zoomControl.update(e)},t.resize=function(e){this._rotateControl.resize(e),this._translateControl.resize(e),this._zoomControl.resize(e)},t.enable=function(){var e=this._view3D;e.rotate&&this._rotateControl.enable(),e.translate&&this._translateControl.enable(),e.zoom&&this._zoomControl.enable()},t.disable=function(){this._rotateControl.disable(),this._translateControl.disable(),this._zoomControl.disable()},t.sync=function(){this._rotateControl.sync(),this._translateControl.sync(),this._zoomControl.sync()},t.updateCursor=function(){var e=this._view3D.useGrabCursor?X:K;this._setCursor(e)},t._setCursor=function(e){var t=this._view3D;(t.useGrabCursor||e===K)&&(t.renderer.canvas.style.cursor=e)},(0,a.Z)(e,[{key:"rotate",get:function(){return this._rotateControl}},{key:"translate",get:function(){return this._translateControl}},{key:"zoom",get:function(){return this._zoomControl}}]),e}(),ft=function(){function e(e,t){var n=this,r=void 0===t?{}:t,a=r.delay,o=void 0===a?2e3:a,s=r.delayOnMouseLeave,c=void 0===s?0:s,l=r.speed,u=void 0===l?1:l,h=r.pauseOnHover,d=void 0!==h&&h,_=r.canInterrupt,v=void 0===_||_,f=r.disableOnInterrupt,p=void 0!==f&&f;this._enabled=!1,this._interrupted=!1,this._interruptionTimer=-1,this._hovering=!1,this._onMouseDown=function(e){n._canInterrupt&&(e.button!==i.LEFT&&e.button!==i.RIGHT||(n._interrupted=!0,n._clearTimeout(),window.addEventListener(j,n._onMouseUp,!1)))},this._onMouseUp=function(){window.removeEventListener(j,n._onMouseUp,!1),n._setUninterruptedAfterDelay(n._delay)},this._onTouchStart=function(){n._canInterrupt&&(n._interrupted=!0,n._clearTimeout())},this._onTouchEnd=function(){n._setUninterruptedAfterDelay(n._delay)},this._onMouseEnter=function(){n._pauseOnHover&&(n._interrupted=!0,n._hovering=!0)},this._onMouseLeave=function(){n._pauseOnHover&&(n._hovering=!1,n._setUninterruptedAfterDelay(n._delayOnMouseLeave))},this._onWheel=function(){n._canInterrupt&&(n._interrupted=!0,n._setUninterruptedAfterDelay(n._delay))},this._view3D=e,this._delay=o,this._delayOnMouseLeave=c,this._speed=u,this._pauseOnHover=d,this._canInterrupt=v,this._disableOnInterrupt=p}var t=e.prototype;return t.destroy=function(){this.disable()},t.update=function(e){this._enabled&&(this._interrupted?this._disableOnInterrupt&&this.disable():this._view3D.camera.yaw+=this._speed*e/100)},t.enable=function(){if(!this._enabled){var e=this._view3D.renderer.canvas;e.addEventListener(F,this._onMouseDown,!1),e.addEventListener(G,this._onTouchStart,{passive:!1,capture:!1}),e.addEventListener(H,this._onTouchEnd,{passive:!1,capture:!1}),e.addEventListener(Y,this._onMouseEnter,!1),e.addEventListener(q,this._onMouseLeave,!1),e.addEventListener(U,this._onWheel,{passive:!1,capture:!1}),this._enabled=!0}},t.disable=function(){if(this._enabled){var e=this._view3D.renderer.canvas;e.removeEventListener(F,this._onMouseDown,!1),window.removeEventListener(j,this._onMouseUp,!1),e.removeEventListener(G,this._onTouchStart,!1),e.removeEventListener(H,this._onTouchEnd,!1),e.removeEventListener(Y,this._onMouseEnter,!1),e.removeEventListener(q,this._onMouseLeave,!1),e.removeEventListener(U,this._onWheel,!1),this._enabled=!1,this._interrupted=!1,this._hovering=!1,this._clearTimeout()}},t._setUninterruptedAfterDelay=function(e){var t=this;this._hovering||(this._clearTimeout(),e>0?this._interruptionTimer=window.setTimeout((function(){t._interrupted=!1,t._interruptionTimer=-1}),e):(this._interrupted=!1,this._interruptionTimer=-1))},t._clearTimeout=function(){this._interruptionTimer>=0&&(window.clearTimeout(this._interruptionTimer),this._interruptionTimer=-1)},(0,a.Z)(e,[{key:"enabled",get:function(){return this._enabled}},{key:"delay",get:function(){return this._delay},set:function(e){this._delay=e}},{key:"delayOnMouseLeave",get:function(){return this._delayOnMouseLeave},set:function(e){this._delayOnMouseLeave=e}},{key:"speed",get:function(){return this._speed},set:function(e){this._speed=e}},{key:"pauseOnHover",get:function(){return this._pauseOnHover},set:function(e){this._pauseOnHover=e}},{key:"canInterrupt",get:function(){return this._canInterrupt},set:function(e){this._canInterrupt=e}},{key:"disableOnInterrupt",get:function(){return this._disableOnInterrupt},set:function(e){this._disableOnInterrupt=e}}]),e}(),pt=n(8331),mt=n(5157),gt=n(7631),wt=function(){function e(e){var t=e.src,n=e.scenes,i=e.animations,r=void 0===i?[]:i,a=e.fixSkinnedBbox,o=void 0!==a&&a,s=e.castShadow,c=void 0===s||s,l=e.receiveShadow,h=void 0!==l&&l;this._src=t;var d=new u.ZAu;d.add.apply(d,n),this._animations=r,this._scene=d;var _=this._getInitialBbox(o),v=_.min.y;d.translateY(-v),d.updateMatrixWorld(),_.translate(new u.Pa4(0,-v,0)),this._fixSkinnedBbox=o,this._bbox=_,this.castShadow=c,this.receiveShadow=h}var t=e.prototype;return t.reduceVertices=function(e,t){var n=this,i=this.meshes,r=t;return i.forEach((function(t){var i=t.geometry.attributes.position;if(i)if(t.updateMatrixWorld(),n._fixSkinnedBbox&&t.isSkinnedMesh)n._forEachSkinnedVertices(t,(function(t){r=e(r,t)}));else for(var a=(0,d.Gr)(i),o=0;o<i.count;o++){var s=(new u.Pa4).fromBufferAttribute(i,o);i.normalized&&s.multiplyScalar(a),s.applyMatrix4(t.matrixWorld),r=e(r,s)}})),r},t._getInitialBbox=function(e){return this._scene.updateMatrixWorld(),e&&this._hasSkinnedMesh()?this._getSkeletonBbox():(new u.ZzF).setFromObject(this._scene)},t._getSkeletonBbox=function(){var e=this,t=new u.ZzF;return this.meshes.forEach((function(n){n.isSkinnedMesh?e._forEachSkinnedVertices(n,(function(e){return t.expandByPoint(e)})):t.expandByObject(n)})),t},t._getAllMeshes=function(){var e=[];return this._scene.traverse((function(t){t.isMesh&&e.push(t)})),e},t._hasSkinnedMesh=function(){return this._getAllMeshes().some((function(e){return e.isSkinnedMesh}))},t._forEachSkinnedVertices=function(e,t){var n=e.geometry,i=n.attributes.position,r=n.attributes.skinIndex,a=n.attributes.skinWeight,o=e.skeleton;o.update();for(var s=o.boneMatrices,c=(0,d.Gr)(i),l=(0,d.Gr)(a),h=function(n){var o=(new u.Pa4).fromBufferAttribute(i,n).multiplyScalar(c),h=new u.Ltg(0,0,0,0),d=new u.Ltg(o.x,o.y,o.z).applyMatrix4(e.bindMatrix),_=[a.getX(n),a.getY(n),a.getZ(n),a.getW(n)].map((function(e){return e*l})),v=[r.getX(n),r.getY(n),r.getZ(n),r.getW(n)];_.forEach((function(e,t){var n=(new u.yGw).fromArray(s,16*v[t]);h.add(d.clone().applyMatrix4(n).multiplyScalar(e))}));var f=(new u.Pa4).fromArray(h.applyMatrix4(e.bindMatrixInverse).toArray());f.applyMatrix4(e.matrixWorld),t(f)},_=0;_<i.count;_++)h(_)},(0,a.Z)(e,[{key:"src",get:function(){return this._src}},{key:"scene",get:function(){return this._scene}},{key:"animations",get:function(){return this._animations}},{key:"meshes",get:function(){return this._getAllMeshes()}},{key:"bbox",get:function(){return this._bbox}},{key:"castShadow",set:function(e){this.meshes.forEach((function(t){return t.castShadow=e}))}},{key:"receiveShadow",set:function(e){this.meshes.forEach((function(t){return t.receiveShadow=e}))}}]),e}(),yt=wt,bt=new mt._,Et=new gt.a,xt=function(e){function t(t){var n;(n=e.call(this,t)||this)._loader=new pt.E;var i=n._loader;return i.setCrossOrigin("anonymous"),i.setDRACOLoader(bt),i.setKTX2Loader(Et.detectSupport(t.renderer.threeRenderer)),n}(0,s.Z)(t,e),t.setMeshoptDecoder=function(){var e=(0,r.Z)(l().mark((function e(n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var a=document.createElement("script");a.addEventListener("load",(0,r.Z)(l().mark((function n(){return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,window.MeshoptDecoder.ready;case 2:t.meshoptDecoder=window.MeshoptDecoder,document.body.removeChild(a),e();case 5:case"end":return n.stop()}}),n)})))),a.addEventListener("error",(function(){document.body.removeChild(a),i()})),a.src=new URL(n,location.href).href,document.body.appendChild(a)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var n=t.prototype;return n.load=function(e){var n=this,i=this._view3D,r=this._loader,a=(0,d.uh)(i,e);return bt.setDecoderPath(i.dracoPath),Et.setTranscoderPath(i.ktxPath),t.meshoptDecoder&&r.setMeshoptDecoder(t.meshoptDecoder),r.manager=u.tEQ,new Promise((function(t,i){try{r.load(e,(function(i){var r=n._parseToModel(i,e);t(r)}),(function(t){return n._onLoadingProgress(t,e,a)}),(function(e){a.initialized=!0,i(e)}))}catch(o){i(o)}}))},n.loadFromFiles=function(e){var n=this,i=this._view3D,r=this._loader,a=[],o=function(){a.forEach((function(e){URL.revokeObjectURL(e)}))};return bt.setDecoderPath(i.dracoPath),Et.setTranscoderPath(i.ktxPath),t.meshoptDecoder&&r.setMeshoptDecoder(t.meshoptDecoder),new Promise((function(t,s){if(e.length<=0)s(new Error("No files found"));else{var c=e.find((function(e){return/\.(gltf|glb)$/i.test(e.name)}));if(c){var l=new Map;e.forEach((function(e){l.set(e.name,e)}));var h=URL.createObjectURL(c);a.push(h);var _=new u.lLk;_.setURLModifier((function(e){if(/^data:.*,.*$/i.test(e))return e;var t=/[^\/|\\]+$/.exec(e),n=t&&t[0]||"";if(l.has(n)){var i=l.get(n),r=URL.createObjectURL(i);return a.push(r),r}return e}));var v=(0,d.uh)(i,h);r.manager=_,r.load(h,(function(e){var i=n._parseToModel(e,c.name);o(),t(i)}),(function(e){return n._onLoadingProgress(e,h,v)}),(function(e){v.initialized=!0,o(),s(e)}))}else s(new Error("No glTF file found"))}}))},n._parseToModel=function(e,t){var n=this._view3D,i=n.fixSkinnedBbox;e.scenes.forEach((function(e){e.traverse((function(e){e.frustumCulled=!1}))}));var a=n.renderer.threeRenderer.capabilities.maxTextureSize,o=[];e.scenes.forEach((function(e){e.traverse((function(e){e.isMesh&&o.push(e)}))}));var s=o.reduce((function(e,t){return[].concat(e,Array.isArray(t.material)?t.material:[t.material])}),[]).reduce((function(e,t){return[].concat(e,ne.xI.filter((function(e){return t[e]})).map((function(e){return t[e]})))}),[]),c=e.parser.associations,u=e.parser.json,h=s.filter((function(e){return c.has(e)})).map((function(e){return u.textures[c.get(e).textures]})).reduce((function(e,t,n){var i=t.extensions&&t.extensions[ne.ei],r=t.extras&&t.extras[ne.Fy];if(!i&&!r)return e;var o=s[n];return(i?t.extensions[ne.ei].levels:t.extras[ne.Fy].levels).forEach((function(t,n){var i=t.index;t.size>a||(e[n]||(e[n]=[]),e[n].push({index:i,texture:o}))})),e}),[]),d=h.map((function(){return!1}));return h.forEach(function(){var t=(0,r.Z)(l().mark((function t(n,i){var r,a;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(n.map((function(t){var n=t.index;return e.parser.getDependency("texture",n)})));case 2:if(r=t.sent,a=d.slice(i+1).some((function(e){return!!e})),d[i]=!0,!a){t.next=7;break}return t.abrupt("return");case 7:r.forEach((function(e,t){var i=n[t].texture;i.image=e.image,i.needsUpdate=!0}));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),new yt({src:t,scenes:e.scenes,animations:e.animations,fixSkinnedBbox:i})},t}(ee),kt=xt,Pt=function(e){function t(t,n){var i,a=void 0===n?{}:n,s=a.src,c=void 0===s?null:s,u=a.iosSrc,h=void 0===u?null:u,_=a.dracoPath,f=void 0===_?"https://www.gstatic.com/draco/versioned/decoders/1.4.1/":_,p=a.ktxPath,m=void 0===p?"https://unpkg.com/three@0.134.0/examples/js/libs/basis/":p,g=a.meshoptPath,w=void 0===g?null:g,y=a.fixSkinnedBbox,b=void 0!==y&&y,E=a.fov,x=void 0===E?v:E,k=a.center,P=void 0===k?v:k,S=a.yaw,M=void 0===S?0:S,T=a.pitch,O=void 0===T?0:T,C=a.initialZoom,L=void 0===C?0:C,I=a.rotate,N=void 0===I||I,R=a.translate,z=void 0===R||R,F=a.zoom,Z=void 0===F||F,j=a.autoplay,G=void 0!==j&&j,B=a.scrollable,H=void 0===B||B,U=a.wheelScrollable,V=void 0!==U&&U,W=a.useGrabCursor,Y=void 0===W||W,q=a.skybox,X=void 0===q?null:q,Q=a.envmap,K=void 0===Q?null:Q,$=a.background,J=void 0===$?null:$,ee=a.exposure,te=void 0===ee?1:ee,ne=a.shadow,ie=void 0===ne||ne,re=a.skyboxBlur,ae=void 0!==re&&re,oe=a.toneMapping,se=void 0===oe?D.LINEAR:oe,ce=a.webAR,ue=void 0===ce||ce,he=a.sceneViewer,de=void 0===he||he,_e=a.quickLook,ve=void 0===_e||_e,pe=a.arPriority,me=void 0===pe?fe:pe,ge=a.poster,we=void 0===ge?null:ge,Ee=a.canvasSelector,ke=void 0===Ee?"canvas":Ee,Pe=a.autoInit,Se=void 0===Pe||Pe,Me=a.autoResize,Te=void 0===Me||Me,Oe=a.useResizeObserver,Ce=void 0===Oe||Oe,De=a.maintainSize,Le=void 0!==De&&De,Ie=a.on,Ne=void 0===Ie?{}:Ie,Re=a.plugins,Ae=void 0===Re?[]:Re,ze=a.maxDeltaTime,Fe=void 0===ze?1/30:ze;return(i=e.call(this)||this)._rootEl=(0,d.sb)(t),i._src=c,i._iosSrc=h,i._dracoPath=f,i._ktxPath=m,i._meshoptPath=w,i._fixSkinnedBbox=b,i._fov=x,i._center=P,i._yaw=M,i._pitch=O,i._initialZoom=L,i._rotate=N,i._translate=z,i._zoom=Z,i._autoplay=G,i._scrollable=H,i._wheelScrollable=V,i._useGrabCursor=Y,i._skybox=X,i._envmap=K,i._background=J,i._exposure=te,i._shadow=ie,i._skyboxBlur=ae,i._toneMapping=se,i._webAR=ue,i._sceneViewer=de,i._quickLook=ve,i._arPriority=me,i._poster=we,i._canvasSelector=ke,i._autoInit=Se,i._autoResize=Te,i._useResizeObserver=Ce,i._maintainSize=Le,i._model=null,i._initialized=!1,i._loadingContext=[],i._plugins=Ae,i._maxDeltaTime=Fe,i._renderer=new A((0,o.Z)(i)),i._camera=new ye((0,o.Z)(i)),i._control=new vt((0,o.Z)(i)),i._scene=new le((0,o.Z)(i)),i._animator=new xe((0,o.Z)(i)),i._autoPlayer=new ft((0,o.Z)(i),(0,d.PO)(G)),i._autoResizer=new be((0,o.Z)(i)),i._arManager=new ut((0,o.Z)(i)),i._addEventHandlers(Ne),i._addPosterImage(),(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i._initPlugins(Ae);case 2:if(!c||!Se){e.next=5;break}return e.next=5,i.init();case 5:case"end":return e.stop()}}),e)})))(),i}(0,s.Z)(t,e);var n=t.prototype;return n.destroy=function(){var e=this;this._scene.reset(),this._renderer.stopAnimationLoop(),this._control.destroy(),this._autoResizer.disable(),this._animator.reset(),this._plugins.forEach((function(t){return t.teardown(e)})),this._plugins=[]},n.init=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,r,a,o,s,c,h,d,v;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._src){e.next=2;break}throw new Pe.Z(_.ZP.MESSAGES.PROVIDE_SRC_FIRST,_.ZP.CODES.PROVIDE_SRC_FIRST);case 2:if(t=this._scene,n=this._renderer,i=this._control,r=this._skybox,a=this._envmap,o=this._background,s=this._meshoptPath,c=[],this.resize(),this._autoResize&&this._autoResizer.enable(),!s||kt.meshoptDecoder){e.next=15;break}return e.next=15,kt.setMeshoptDecoder(s);case 15:return(r||a)&&(h=new u.Mig,t.add(h,!1),d=r?t.setSkybox(r):t.setEnvMap(a),c.push(d.then((function(){t.remove(h)})))),!r&&o&&c.push(t.setBackground(o)),v=this._loadModel(this._src),c.push.apply(c,v),this._resetLoadingContextOnFinish(c),e.next=23,Promise.race(v);case 23:i.enable(),this._autoplay&&this._autoPlayer.enable(),n.stopAnimationLoop(),n.setAnimationLoop(n.defaultRenderLoop),this._initialized=!0,this.trigger(f,{type:f,target:this});case 29:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.resize=function(){var e=this._renderer,t=this._initialized?e.size:null;e.resize();var n=e.size;this._camera.resize(n,t),this._control.resize(n),e.threeRenderer.xr.isPresenting||e.defaultRenderLoop(0),this.trigger(b,Object.assign({},n,{type:b,target:this}))},n.load=function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._initialized){e.next=8;break}return n=this._loadModel(t),this._resetLoadingContextOnFinish(n),e.next=5,Promise.race(n);case 5:this._src=t,e.next=11;break;case 8:return this._src=t,e.next=11,this.init();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.display=function(e,t){var n=(void 0===t?{}:t).resetCamera,i=void 0===n||n,r=this._renderer,a=this._scene,o=this._camera,s=this._animator,c=r.threeRenderer.xr.isPresenting;if(a.reset(),a.add(e.scene),a.shadowPlane.updateDimensions(e),i&&(o.fit(e,this._center),o.reset(0)),s.reset(),s.setClips(e.animations),e.animations.length>0&&s.play(0),this._model=e,c){var l=this._arManager.activeSession;l&&l.control.syncTargetModel(e)}this.trigger(y,{type:y,target:this,model:e})},n.loadPlugins=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,r,a=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=a.length,i=new Array(n),r=0;r<n;r++)i[r]=a[r];return e.next=3,this._initPlugins(i);case 3:(t=this._plugins).push.apply(t,i);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.removePlugins=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,r=this,a=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,n=new Array(t),i=0;i<t;i++)n[i]=a[i];return e.next=3,Promise.all(n.map((function(e){return e.teardown(r)})));case 3:n.forEach((function(e){var t=r._plugins.indexOf(e);t<0||r._plugins.splice(t,1)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.screenshot=function(e){void 0===e&&(e="screenshot");var t=this._renderer.canvas.toDataURL("png"),n=document.createElement("a");n.href=t,n.download=e,n.click()},n._loadModel=function(e){var t=this,n=new kt(this);if(Array.isArray(e)){var i=e.map((function(){return!1}));return e.map((function(e,r){return t._loadSingleModel(n,e,r,i)}))}return[this._loadSingleModel(n,e,0,[!1])]},n._loadSingleModel=function(){var e=(0,r.Z)(l().mark((function e(t,n,i,r){var a,o,s,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length-1,this.trigger(p,{type:p,target:this,src:n,level:i,maxLevel:a}),e.prev=2,e.next=5,t.load(n);case 5:if(o=e.sent,s=r.slice(i+1).some((function(e){return!!e})),c=r.some((function(e){return!!e})),this.trigger(m,{type:m,target:this,model:o,level:i,maxLevel:a}),r[i]=!0,!s){e.next=12;break}return e.abrupt("return");case 12:this.display(o,{resetCamera:!c}),e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(2),this.trigger(g,{type:g,target:this,level:i,maxLevel:a,error:e.t0}),new Pe.Z(_.ZP.MESSAGES.MODEL_FAIL_TO_LOAD(n),_.ZP.CODES.MODEL_FAIL_TO_LOAD);case 19:case"end":return e.stop()}}),e,this,[[2,15]])})));return function(t,n,i,r){return e.apply(this,arguments)}}(),n._addEventHandlers=function(e){var t=this;Object.keys(e).forEach((function(n){t.on(n,e[n])}))},n._addPosterImage=function(){var e=this._poster,t=this._rootEl;if(e){var n,i=(0,d.kK)(e);if(i||(0,d.dN)(e)){var r=i?e:t.querySelector(e);if(!r)throw new Pe.Z(_.ZP.MESSAGES.ELEMENT_NOT_FOUND(e),_.ZP.CODES.ELEMENT_NOT_FOUND);n=r}else{var a=document.createElement("img");a.className=C,a.src=e,t.appendChild(a),n=a,this.once(f,(function(){a.parentElement===t&&t.removeChild(a)}))}this.once(f,(function(){n.parentElement&&n.parentElement.removeChild(n)}))}},n._initPlugins=function(){var e=(0,r.Z)(l().mark((function e(t){var n=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e){return e.init(n)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n._resetLoadingContextOnFinish=function(){var e=(0,r.Z)(l().mark((function e(t){var n=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Promise.all(t).then((function(){n.trigger(w,{type:w,target:n}),n._loadingContext=[]}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(0,a.Z)(t,[{key:"renderer",get:function(){return this._renderer}},{key:"scene",get:function(){return this._scene}},{key:"camera",get:function(){return this._camera}},{key:"control",get:function(){return this._control}},{key:"autoPlayer",get:function(){return this._autoPlayer}},{key:"model",get:function(){return this._model}},{key:"animator",get:function(){return this._animator}},{key:"ar",get:function(){return this._arManager}},{key:"rootEl",get:function(){return this._rootEl}},{key:"initialized",get:function(){return this._initialized}},{key:"loadingContext",get:function(){return this._loadingContext}},{key:"plugins",get:function(){return this._plugins}},{key:"src",get:function(){return this._src}},{key:"iosSrc",get:function(){return this._iosSrc}},{key:"dracoPath",get:function(){return this._dracoPath}},{key:"ktxPath",get:function(){return this._ktxPath}},{key:"meshoptPath",get:function(){return this._meshoptPath}},{key:"fixSkinnedBbox",get:function(){return this._fixSkinnedBbox}},{key:"fov",get:function(){return this._fov}},{key:"center",get:function(){return this._center}},{key:"yaw",get:function(){return this._yaw}},{key:"pitch",get:function(){return this._pitch}},{key:"initialZoom",get:function(){return this._initialZoom}},{key:"rotate",get:function(){return this._rotate}},{key:"translate",get:function(){return this._translate}},{key:"zoom",get:function(){return this._zoom}},{key:"autoplay",get:function(){return this._autoplay}},{key:"scrollable",get:function(){return this._scrollable}},{key:"wheelScrollable",get:function(){return this._wheelScrollable}},{key:"useGrabCursor",get:function(){return this._useGrabCursor},set:function(e){this._useGrabCursor=e,this._control.updateCursor()}},{key:"skybox",get:function(){return this._skybox},set:function(e){this._scene.setSkybox(e),this._skybox=e}},{key:"envmap",get:function(){return this._envmap},set:function(e){this._scene.setEnvMap(e),this._envmap=e}},{key:"background",get:function(){return this._background}},{key:"exposure",get:function(){return this._exposure},set:function(e){this._renderer.threeRenderer.toneMappingExposure=e,this._exposure=e}},{key:"shadow",get:function(){return this._shadow}},{key:"skyboxBlur",get:function(){return this._skyboxBlur},set:function(e){this._skyboxBlur=e;var t=this._scene,n=t.root.environment;n&&t.skybox&&(e?t.skybox.useBlurredHDR(n):t.skybox.useTexture(n))}},{key:"toneMapping",get:function(){return this._toneMapping},set:function(e){this._toneMapping=e,this._renderer.threeRenderer.toneMapping=e}},{key:"webAR",get:function(){return this._webAR}},{key:"sceneViewer",get:function(){return this._sceneViewer}},{key:"quickLook",get:function(){return this._quickLook}},{key:"arPriority",get:function(){return this._arPriority}},{key:"poster",get:function(){return this._poster}},{key:"canvasSelector",get:function(){return this._canvasSelector}},{key:"autoInit",get:function(){return this._autoInit}},{key:"autoResize",get:function(){return this._autoResize}},{key:"useResizeObserver",get:function(){return this._useResizeObserver}},{key:"maintainSize",get:function(){return this._maintainSize},set:function(e){this._maintainSize=e}},{key:"maxDeltaTime",get:function(){return this._maxDeltaTime},set:function(e){this._maxDeltaTime=e}}]),t}(h.Z);Pt.VERSION="#__VERSION__#";var St=Pt,Mt=function(){function e(e){void 0===e&&(e={}),this._options=e,this._button=null}var t=e.prototype;return t.init=function(){var e=(0,r.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._addButton(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.teardown=function(e){var t=this._button;t&&(t.parentElement===e.rootEl&&e.rootEl.removeChild(t),this._button=null)},t._addButton=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,r,a,o,s,c,u,h,d,_,v,f,p=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._options,i=n.availableText,r=void 0===i?"View in AR":i,a=n.unavailableText,o=void 0===a?"AR is not available in this browser":a,s=n.buttonClass,c=void 0===s?"view3d-ar-button":s,u=n.tooltipClass,h=void 0===u?"view3d-tooltip":u,e.next=3,t.ar.isAvailable();case 3:if(d=e.sent,_=document.createElement("button"),v=document.createElement("div"),f=document.createTextNode(d?r:o),_.classList.add(c),v.classList.add(h),_.disabled=!0,_.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="32px" height="32px"><g><rect fill="none" height="24" width="24" x="0" y="0"/></g><g><g><path d="M3,4c0-0.55,0.45-1,1-1h2V1H4C2.34,1,1,2.34,1,4v2h2V4z"/><path d="M3,20v-2H1v2c0,1.66,1.34,3,3,3h2v-2H4C3.45,21,3,20.55,3,20z"/><path d="M20,1h-2v2h2c0.55,0,1,0.45,1,1v2h2V4C23,2.34,21.66,1,20,1z"/><path d="M21,20c0,0.55-0.45,1-1,1h-2v2h2c1.66,0,3-1.34,3-3v-2h-2V20z"/><path d="M19,14.87V9.13c0-0.72-0.38-1.38-1-1.73l-5-2.88c-0.31-0.18-0.65-0.27-1-0.27s-0.69,0.09-1,0.27L6,7.39 C5.38,7.75,5,8.41,5,9.13v5.74c0,0.72,0.38,1.38,1,1.73l5,2.88c0.31,0.18,0.65,0.27,1,0.27s0.69-0.09,1-0.27l5-2.88 C18.62,16.25,19,15.59,19,14.87z M11,17.17l-4-2.3v-4.63l4,2.33V17.17z M12,10.84L8.04,8.53L12,6.25l3.96,2.28L12,10.84z M17,14.87l-4,2.3v-4.6l4-2.33V14.87z"/></g></g></svg>',_.appendChild(v),v.appendChild(f),t.rootEl.appendChild(_),this._button=_,!t.initialized){e.next=20;break}return e.next=18,this._setAvailable(t,_,d);case 18:e.next=21;break;case 20:t.once(y,(function(){p._setAvailable(t,_,d)}));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._setAvailable=function(){var e=(0,r.Z)(l().mark((function e(t,n,i){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i?(n.disabled=!1,n.addEventListener("click",(function(){t.ar.enter()}))):n.disabled=!0;case 1:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),e}(),Tt=Mt,Ot=function(){function e(e){void 0===e&&(e={}),this._options=e}var t=e.prototype;return t.init=function(){var e=(0,r.Z)(l().mark((function e(t){var n=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on(S,(function(e){var i=e.session,r=i.domOverlay.root;if(r){if(n._cachedElements)Object.values(n._cachedElements).map((function(e){r.contains(e)||r.appendChild(e)}));else{var a=document.createElement("div");a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48px" height="48px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>',a.classList.add("view3d-ar-close"),r.appendChild(a),n._cachedElements={closeButton:a}}var o=n._cachedElements.closeButton,s=function(){i.exit()};o.addEventListener("click",s),t.once(M,(function(){o.parentElement&&o.parentElement.removeChild(o),o.removeEventListener("click",s)}))}}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.teardown=function(){},e}(),Ct=Ot,Dt=function(){function e(t){var n=this;void 0===t&&(t={}),this._startLoading=function(t){var i=t.target;if(0===t.level){var r=n._options,a=r.type,o=void 0===a?"default":a,s=r.loadingLabel,c=void 0===s?"Loading 3D Model...":s,l=r.parsingLabel,u=void 0===l?"Parsing 3D Model...":l,h=r.labelColor,d=void 0===h?"#ffffff":h,_=r.barWidth,v=void 0===_?"70%":_,f=r.barHeight,p=void 0===f?"10px":f,m=r.barBackground,g=void 0===m?"#bbbbbb":m,y=r.barForeground,b=void 0===y?"#3e8ed0":y,E=r.spinnerWidth,x=void 0===E?"30%":E,P=r.overlayBackground,S=void 0===P?"rgba(0, 0, 0, 0.3)":P,M=document.createElement("div"),T=document.createElement("div"),O=document.createElement("div"),C=document.createElement("div"),D=document.createElement("div");if(M.classList.add("view3d-lb-overlay"),T.classList.add("view3d-lb-wrapper"),C.classList.add("view3d-lb-base"),O.classList.add("view3d-lb-label"),D.classList.add("view3d-lb-filler"),M.style.backgroundColor=S,o!==e.TYPE.SPINNER?(C.style.height=p,C.style.backgroundColor=g,D.style.backgroundColor=b):(C.classList.add("type-spinner"),C.style.width=x,C.style.paddingTop=x,D.style.borderWidth=p,D.style.borderColor=b,D.style.borderLeftColor="transparent"),o===e.TYPE.TOP?M.classList.add("type-top"):o===e.TYPE.DEFAULT&&(C.style.width=v),O.style.color=d,O.innerText=c,C.appendChild(D),T.appendChild(C),T.appendChild(O),M.appendChild(T),i.rootEl.appendChild(M),o!==e.TYPE.SPINNER){var L=function(){if(i.loadingContext.every((function(e){return e.initialized}))){var e=i.loadingContext.filter((function(e){return e.lengthComputable})).reduce((function(e,t){return e[0]+=t.loaded,e[1]+=t.total,e}),[0,0]),t=e[0],n=e[1];if(!(n<=0)){var r=t/n*100;D.style.width=r.toFixed(2)+"%",t===n&&(O.innerText=u)}}};i.on(k,L),i.once(w,(function(){i.off(k,L)}))}i.once(w,(function(){n._removeOverlay(i)})),n._overlay=M}},this._options=t}var t=e.prototype;return t.init=function(){var e=(0,r.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on(p,this._startLoading);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.teardown=function(e){e.off(p,this._startLoading),this._removeOverlay(e)},t._removeOverlay=function(e){var t=this._overlay;t&&(t.parentElement===e.rootEl&&e.rootEl.removeChild(t),this._overlay=null)},e}();Dt.TYPE={DEFAULT:"default",TOP:"top",SPINNER:"spinner"};var Lt=Dt,It=St},8519:function(e,t,n){n.d(t,{hj:function(){return o},kK:function(){return c},S3:function(){return l},sb:function(){return u},gE:function(){return h},dN:function(){return d},c$:function(){return _},Dc:function(){return v},uZ:function(){return f},t7:function(){return p},zc:function(){return m},TS:function(){return g},hl:function(){return w},cM:function(){return y},PO:function(){return b},Pr:function(){return E},YC:function(){return x},uh:function(){return k},Gr:function(){return P}});var i=n(4412),r=n(6872),a=n(9911),o=function(e){return"number"==typeof e},s=function(e){return"string"==typeof e},c=function(e){return!!e&&e.nodeType===Node.ELEMENT_NODE},l=function(e,t){var n=null;if(s(e)){var i=(t||document).querySelector(e);if(!i)throw new r.Z(a.ZP.MESSAGES.ELEMENT_NOT_FOUND(e),a.ZP.CODES.ELEMENT_NOT_FOUND);n=i}else c(e)&&(n=e);return n},u=function(e,t){var n=l(e,t);if(!n)throw new r.Z(a.ZP.MESSAGES.WRONG_TYPE(e,["HTMLElement","string"]),a.ZP.CODES.WRONG_TYPE);return n},h=function(e,t){var n=e.querySelector(t);if(!n)throw new r.Z(a.ZP.MESSAGES.CANVAS_NOT_FOUND,a.ZP.CODES.CANVAS_NOT_FOUND);return n},d=function(e){if(!s(e))return!1;var t=document.createDocumentFragment();try{t.querySelector(e)}catch(n){return!1}return!0},_=function(e){return e*Math.PI/180},v=function(e){return 180*e/Math.PI},f=function(e,t,n){return Math.max(Math.min(e,n),t)},p=function(e,t,n){return e*(1-n)+t*n},m=function(e,t,n){var i=Math.abs(n-t);if(e<t)e=n-(t-e)%i;else if(e>n){e=t+(e-n)%i}return e},g=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.forEach((function(t){Object.keys(t).forEach((function(n){var i=t[n];Array.isArray(e[n])&&Array.isArray(i)?e[n]=[].concat(e[n],i):e[n]=i}))})),e},w=function(e){for(var t=1;t<e;)t*=2;return t},y=function(e,t,n){var r=(new i.FM8).subVectors(t,e).normalize(),a=(new i.FM8).subVectors(n,e).normalize().angle()-r.angle(),o=-Math.sign(a)*(2*Math.PI-Math.abs(a));return Math.abs(a)<Math.abs(o)?a:o},b=function(e){return"object"==typeof e?e:{}},E=function(e){return e?"true":"false"},x=function(e,t,n){var r=_(t),a=_(n),o=new i.Pa4(0,0,0);return o.y=e*Math.sin(a),o.z=e*Math.cos(a),o.x=o.z*Math.sin(-r),o.z=o.z*Math.cos(-r),o},k=function(e,t){var n={src:t,loaded:0,total:0,lengthComputable:!1,initialized:!1};return e.loadingContext.push(n),n},P=function(e){if(e.normalized&&ArrayBuffer.isView(e.array)){var t=e.array,n=S(t),i=1/(Math.pow(2,8*t.BYTES_PER_ELEMENT)-1);return n?2*i:i}return 1},S=function(e){var t=new e.constructor(1);return t[0]=-1,t[0]<0}}}]);